<?xml version="1.0" encoding="UTF-8"?>
<Document>
 <Model version="4.8" build="4.8.2.10124">
  <Sidops><![CDATA[model 0 0
 description '<Information>
 <Description>
    <LibraryPath>C:\Users\mihir\Downloads\Bond-graph-simulations-main (1)\Bond-graph-simulations-main\22Elements_NoFriction_Impact@10th_FixedDamping.emx</LibraryPath>
  <TimeStamp>2022-4-25 12:29:41</TimeStamp>
  <Version>4.8</Version>
</Description>
</Information>';
 type 'Mainmodel-213'
 end;
 implementation bg
  submodels
   C1 168 32
    type 'C-3'
     ports
      power in p [3,1];
      signal out state [3,1];
     restrictions
      causality preferred out p;
     parameters
      real c[3,3] = [1.0e-8, 0.0, 0.0; 0.0, 1.0e-8, 0.0; 0.0, 0.0, 1.0e-8];
    end;
    icon bg bottom
     figures
      text 'C' 168 32 color 0 18 bold;
    end;
    implementation eq
equations
    state = int(p.f);
    p.e = inverse(c) *state;
       implementation_end;
   C2 168 528
    type 'C-3'
     ports
      power in p [3,1];
      signal out state [3,1];
     restrictions
      causality preferred out p;
     parameters
      real c[3,3] = [1.0e-6, 0.0, 0.0; 0.0, 1.0e-6, 0.0; 0.0, 0.0, 1.0e-6];
    end;
    icon bg bottom
     figures
      text 'C' 168 528 color 0 18 bold;
    end;
    implementation eq
equations
    state = int(p.f);
    p.e = inverse(c) *state;
       implementation_end;
   Definitions 408 80
    description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\Constant.emx</LibraryPath><TimeStamp>2007-10-19 14:48:44</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
    type Constant
     ports
      signal in v_in;
      signal in Rho_in;
      signal in Tau_in;
      signal in K_in;
    end;
    icon bg bottom
     figures
      rectangle 392 64.1 424 95.9 color 0 fill 15132390;
      line 403.6 68.9 403.6 90.9 color 16711680 width 2;
      line 414.7 66.2 414.7 91.9 color 0;
      line 398.7 68.5 417 68.5 color 0;
    end;
    implementation eq
parameters
//Element masses
	real global mass_p = 196.8  {kg};					
	
//Element Lengths
	real global L_p = 9.32 {m}; 					// Pipe segment length 4.282075

//Compliance values of the pipe element	
	real global C_A = 1.90E-08;		// Axial Compliance {1/Nm}
	real global C_B = 1.45E-05; 	// Bending Compliance {rad/Nm}
	real global C_S = 2.37E-07; 				// Shear Compliance
	real global C_T = 1.20E-05;				// Torsional compliance
	
//Well-bore impact damping	
	real global R_WB = 1E2;
	real global R_CON = 1E4;
//Gravitational acceleration
	real global g = 9.8066; //9.8066; // m s-2

//Radii	
	real global r_w = 0.1; // {m} inner radius of the well bore (Max=100 mm in the damping model)
	real global r_upset_o = 0.06354;// (0.06354 is the upset area radius);
	real global r_p_o = 0.04445;
	real global r_p_i = 0.0351;

//Well-bore interaction related properties	
	real global k_w = 1e6; // stiffness of pipe & Well-bore
	//real global mu_k = 0.1; // dynamic coefficient of friction
	//real global mu_brk = 0.15; // Limiting friction coefficient
	//real global zo11[3,1];
	
// Friction model parameters
//	real global v_brk = 0.1; //Breakaway friction velocity
//	real global f = 100; //N/(m/s)



//Fluid properties and states***************

variables
	
	real global Tau{Pa} ;
	real global K ;//{kg/m s}
	real global Rho; // kg/m^3
	real global v {m/s};
	
	real global C_c [3,3];// Critical damping constant
	
	real global I_p[3,3];// Moment of inertia of the pipe

	real global rA_Gp[3,1];// The position vector of 'A' w.r.t 'G' of pipe
	real global rB_Gp[3,1];
	
	real global K_SSA_p[3,3];
	real global K_BBT_p[3,3];
	
	real global R_SSA_p[3,3];
	real global R_BBT_p[3,3];
	
equations
	Tau 	= Tau_in;
	K 		= K_in;
	Rho 	= Rho_in;
	v 		= v_in;
	
	I_p[1, 1] = 1/12*mass_p*L_p^2; // moment of inertia about an axis passing through the center of mass perpendicular to its length {kgm^2}
	I_p[1, 2] = 0;
	I_p[1, 3] = 0;
	I_p[2, 1] = 0;
	I_p[2, 2] = 1/12*mass_p*L_p^2; // moment of inertia about an axis passing through the center of mass perpendicular to its length {kgm^2}
	I_p[2, 3] = 0;
	I_p[3, 1] = 0;
	I_p[3, 2] = 0;
	I_p[3, 3] = 1/2*mass_p*(r_p_i^2 + r_p_o^2); //A bout the axix of symmetry {kgm^2}
	
// The position vector of A and B w.r.t the body fixed coordinate system
	
	rA_Gp[1,1] = 0;
	rA_Gp[2,1] = 0;
	rA_Gp[3,1] = -L_p/2;
	
	rB_Gp[1,1] = 0;
	rB_Gp[2,1] = 0;
	rB_Gp[3,1] = L_p/2;
	
// Stiffness values (Pipe): Shear, Shear, Axial
	K_SSA_p[1, 1] = 1/C_S; 
	K_SSA_p[1, 2] = 0;
	K_SSA_p[1, 3] = 0;
	K_SSA_p[2, 1] = 0;
	K_SSA_p[2, 2] = 1/C_S; 
	K_SSA_p[2, 3] = 0;
	K_SSA_p[3, 1] = 0;
	K_SSA_p[3, 2] = 0;
	K_SSA_p[3, 3] = 1/C_A; 	
	
// Stiffnesses values (pipe): Bending, Bnding, Torsional: 

	K_BBT_p[1, 1] = 1/C_B;
	K_BBT_p[1, 2] = 0;
	K_BBT_p[1, 3] = 0;
	K_BBT_p[2, 1] = 0;
	K_BBT_p[2, 2] = 1/C_B;
	K_BBT_p[2, 3] = 0;
	K_BBT_p[3, 1] = 0;
	K_BBT_p[3, 2] = 0;
	K_BBT_p[3, 3] = 1/C_T;

// Damping constant

	C_c [1,1] = 2*sqrt(K_SSA_p[1,1]*mass_p);
	C_c [1,2] = 0;
	C_c [1,3] = 0;
	C_c [2,1] = 0;
	C_c [2,2] = 2*sqrt(K_SSA_p[2,2]*mass_p);
	C_c [2,3] = 0;
	C_c [3,1] = 0;
	C_c [3,2] = 0;
	C_c [3,3] = 0;

	R_BBT_p[1, 1] = R_CON;//1E5;
	R_BBT_p[1, 2] = 0;
	R_BBT_p[1, 3] = 0;
	R_BBT_p[2, 1] = 0;
	R_BBT_p[2, 2] = R_CON;//1E5;
	R_BBT_p[2, 3] = 0;
	R_BBT_p[3, 1] = 0;
	R_BBT_p[3, 2] = 0;
	R_BBT_p[3, 3] = R_CON;//1E5;implementation_end;
   FEB_01 248 216
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
    type Submodel
     ports
      power in Om_B10_IN [3,1];
      power in V_B10_IN [3,1];
      signal in Cardan_IN [3,1];
      power out om_B10_OUT [3,1];
      signal out Cardan_OUT [3,1];
      power out v_B10_OUT [3,1];
    end;
    implementation bg
     submodels
      Element_02 216 208
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 408 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 384 304 432 336 color 0 fill 15132390;
            text 'Cardan' 408 320 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 232
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 232 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 448 416
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 448 416 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 448 232
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 448 232 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 480 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 464 344.1 496 375.9 color 0 fill 15132390;
            text 'R01' 480 360 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 383 267.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 383 267.5 color 0 21 bold;
           terminals
            P 400 263.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 400 384
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 400 384 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 280
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 280 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;
p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 408
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 408 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 352;
         plug p1 448 560;
         plug output1 560 568;
         plug output 560 40;
         plug P 176 248;
         plug p 448 40;
         OneJunction 800 88
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 800 88 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 800 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 800 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 520 432
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 587 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 565 154 609.1 214 color 0 fill 14013909;
            text 'R01' 587.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 592 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 570 442 614 502 color 0 fill 14013909;
            text 'R01' 592 472 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 619.1 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 597.1 290 641.1 350 color 0 fill 14013909;
            text 'R01' 619.1 320 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 331.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 315.1 152.2 347.1 184 color 0 fill 15132390;
            line 326.8 157 326.8 179 color 16711680 width 2;
            line 337.9 154.3 337.9 180 color 0;
            line 321.9 156.6 340.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 331.1 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 315.1 472.1 347.1 503.9 color 0 fill 15132390;
            line 326.8 476.9 326.8 498.9 color 16711680 width 2;
            line 337.9 474.2 337.9 499.9 color 0;
            line 321.9 476.5 340.1 476.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 728 88
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 728 88 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 728 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 728 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 364.8 939.2 371.2 color -1 fill 0;
            ellipse 931.7 363.7 940.3 372.3 color -1;
           terminals
            input 936 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 560 320
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 316.8 563.2 323.2 color -1 fill 0;
            ellipse 555.7 315.7 564.3 324.3 color -1;
           terminals
            input 560 320 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 560 232
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 228.8 563.2 235.2 color -1 fill 0;
            ellipse 555.7 227.7 564.3 236.3 color -1;
           terminals
            input 560 232 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 560 400
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 396.8 563.2 403.2 color -1 fill 0;
            ellipse 555.7 395.7 564.3 404.3 color -1;
           terminals
            input 560 400 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 824 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 820.8 180.8 827.2 187.2 color -1 fill 0;
            ellipse 819.7 179.7 828.3 188.3 color -1;
           terminals
            input 824 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter8 360 320
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 316.8 363.2 323.2 color -1 fill 0;
            ellipse 355.7 315.7 364.3 324.3 color -1;
           terminals
            input 360 320 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 824 472
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 820.8 468.8 827.2 475.2 color -1 fill 0;
            ellipse 819.7 467.7 828.3 476.3 color -1;
           terminals
            input 824 472 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 648 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 448 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 448 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 800 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 800 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 448 472
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 448 472 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 648 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 472 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 800 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 800 472 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 320 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 448 272
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 448 272 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 800 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 800 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 800 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 800 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 331 232.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 299 208.6 363 255.6 color 0 fill 12895428;
            text 'w X rA/G' 331 232.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 331 416
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 299 392.6 363.1 439.5 color 0 fill 12895428;
            text 'w X rB/G' 331.1 416.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 331.1 320.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 331.1 320.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 872 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 9.32];
          end;
          icon bg bottom
           figures
            rectangle 856 48 888 80 color 0 fill 15132390;
            text 'ò' 869.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 872 568
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 9.5];
          end;
          icon bg bottom
           figures
            rectangle 856 552 888 584 color 0 fill 15132390;
            text 'ò' 869.3 568 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 352
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 336 872 368 color 0 fill 15132390;
            text '∫' 853.3 352 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 368;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 824 64;
         Splitter8\output -> Body3_213\w;
         Splitter8\output -> Gain\input 400 360;
         Splitter9\output -> X_B2\input 824 568;
         vA_0\P => vA_2\P;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 560 272;
         w_1\outp -> Splitter8\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_03 216 448
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 432 256 464 color 0 fill 16777152;
         text 'name' 216 448 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 416 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 392 312 440 344 color 0 fill 15132390;
            text 'Cardan' 416 328 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 240
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 240 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 456 424
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 456 424 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 456 240
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 456 240 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 496 368
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 480 352.1 512 383.9 color 0 fill 15132390;
            text 'R01' 496 368 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 343 275.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 343 275.9 color 0 21 bold;
           terminals
            P 360 271.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 360 400
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 360 400 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 288
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 288 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 416
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 416 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 368;
         plug p1 456 592;
         plug output1 592 592;
         plug output 592 16;
         plug P 168 280;
         plug p 456 16;
         OneJunction 680 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 680 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 680 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 680 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 232 384
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 232 384 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 536 440
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 627 176
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 605 146 649.1 206 color 0 fill 14013909;
            text 'R01' 627.1 176 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 624 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 602 450 646 510 color 0 fill 14013909;
            text 'R01' 624 480 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 651.1 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 629.1 298 673.1 358 color 0 fill 14013909;
            text 'R01' 651.1 328 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 291.1 160.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 275.1 144.2 307.1 176 color 0 fill 15132390;
            line 286.8 149 286.8 171 color 16711680 width 2;
            line 297.9 146.3 297.9 172 color 0;
            line 281.9 148.6 300.1 148.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 291.1 496
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 275.1 480.1 307.1 511.9 color 0 fill 15132390;
            line 286.8 484.9 286.8 506.9 color 16711680 width 2;
            line 297.9 482.2 297.9 507.9 color 0;
            line 281.9 484.5 300.1 484.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 608 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 608 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 608 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 608 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 376
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 372.8 939.2 379.2 color -1 fill 0;
            ellipse 931.7 371.7 940.3 380.3 color -1;
           terminals
            input 936 376 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 592 328
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 324.8 595.2 331.2 color -1 fill 0;
            ellipse 587.7 323.7 596.3 332.3 color -1;
           terminals
            input 592 328 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 592 240
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 236.8 595.2 243.2 color -1 fill 0;
            ellipse 587.7 235.7 596.3 244.3 color -1;
           terminals
            input 592 240 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 592 408
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 404.8 595.2 411.2 color -1 fill 0;
            ellipse 587.7 403.7 596.3 412.3 color -1;
           terminals
            input 592 408 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 352 328
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 324.8 355.2 331.2 color -1 fill 0;
            ellipse 347.7 323.7 356.3 332.3 color -1;
           terminals
            input 352 328 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 704 176
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 700.8 172.8 707.2 179.2 color -1 fill 0;
            ellipse 699.7 171.7 708.3 180.3 color -1;
           terminals
            input 704 176 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 704 480
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 700.8 476.8 707.2 483.2 color -1 fill 0;
            ellipse 699.7 475.7 708.3 484.3 color -1;
           terminals
            input 704 480 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 680 176
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 680 176 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 456 176
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 456 176 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 456 480
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 456 480 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 680 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 680 480 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 328 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 456 280
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 456 280 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 680 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 680 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 680 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 680 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 291 240.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 259 216.6 323 263.6 color 0 fill 12895428;
            text 'w X rA/G' 291 240.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 291 424
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 259 400.6 323.1 447.5 color 0 fill 12895428;
            text 'w X rB/G' 291.1 424.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 291.1 328.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 291.1 328.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 752 56
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 18.64];
          end;
          icon bg bottom
           figures
            rectangle 736 40 768 72 color 0 fill 15132390;
            text 'ò' 749.3 56 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 752 576
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 18.25];
          end;
          icon bg bottom
           figures
            rectangle 736 560 768 592 color 0 fill 15132390;
            text 'ò' 749.3 576 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 360
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 344 872 376 color 0 fill 15132390;
            text '∫' 853.3 360 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 376;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 392 368;
         Splitter7\output -> X_A\input 704 56;
         Splitter9\output -> X_B1\input 704 576;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 568 280;
         w_1\outp -> Splitter5\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_04 216 688
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 512 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 496 336.1 528 367.9 color 0 fill 15132390;
            text 'R01' 512 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 176 168;
         plug p1 440 624;
         plug output1 608 616;
         plug output 608 48;
         plug P 176 384;
         plug p 440 56;
         OneJunction 848 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 848 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 848 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 848 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 552 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 130 657.1 190 color 0 fill 14013909;
            text 'R01' 635.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 640 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 618 434 662 494 color 0 fill 14013909;
            text 'R01' 640 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 667.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 645.1 282 689.1 342 color 0 fill 14013909;
            text 'R01' 667.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 776 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 776 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 776 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 776 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 608 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 308.8 611.2 315.2 color -1 fill 0;
            ellipse 603.7 307.7 612.3 316.3 color -1;
           terminals
            input 608 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 608 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 220.8 611.2 227.2 color -1 fill 0;
            ellipse 603.7 219.7 612.3 228.3 color -1;
           terminals
            input 608 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 608 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 388.8 611.2 395.2 color -1 fill 0;
            ellipse 603.7 387.7 612.3 396.3 color -1;
           terminals
            input 608 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 872 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 868.8 156.8 875.2 163.2 color -1 fill 0;
            ellipse 867.7 155.7 876.3 164.3 color -1;
           terminals
            input 872 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 872 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 868.8 460.8 875.2 467.2 color -1 fill 0;
            ellipse 867.7 459.7 876.3 468.3 color -1;
           terminals
            input 872 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 696 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 848 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 848 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 696 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 848 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 848 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 848 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 848 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 848 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 848 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 920 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 27.96];
          end;
          icon bg bottom
           figures
            rectangle 904 24 936 56 color 0 fill 15132390;
            text 'ò' 917.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 920 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 9.5];
          end;
          icon bg bottom
           figures
            rectangle 904 544 936 576 color 0 fill 15132390;
            text 'ò' 917.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 392 352;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 872 40;
         Splitter9\output -> X_B2\input 872 560;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_05 216 912
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 896 256 928 color 0 fill 16777152;
         text 'name' 216 912 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 184 328;
         plug p1 432 712;
         plug output1 496 712;
         plug output 488 40;
         plug P 176 288;
         plug p 440 40;
         OneJunction 688 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 37.28];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 10.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_06 216 1176
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 488 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 472 336.1 504 367.9 color 0 fill 15132390;
            text 'R01' 488 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 168 216;
         plug p1 440 576;
         plug output1 592 576;
         plug output 592 16;
         plug P 192 360;
         plug p 440 24;
         OneJunction 824 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 824 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 824 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 824 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 528 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 619 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 597 130 641.1 190 color 0 fill 14013909;
            text 'R01' 619.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 624 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 602 434 646 494 color 0 fill 14013909;
            text 'R01' 624 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 651.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 629.1 282 673.1 342 color 0 fill 14013909;
            text 'R01' 651.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 752 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 752 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 752 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 752 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 592 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 308.8 595.2 315.2 color -1 fill 0;
            ellipse 587.7 307.7 596.3 316.3 color -1;
           terminals
            input 592 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 592 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 220.8 595.2 227.2 color -1 fill 0;
            ellipse 587.7 219.7 596.3 228.3 color -1;
           terminals
            input 592 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 592 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 388.8 595.2 395.2 color -1 fill 0;
            ellipse 587.7 387.7 596.3 396.3 color -1;
           terminals
            input 592 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 848 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 844.8 156.8 851.2 163.2 color -1 fill 0;
            ellipse 843.7 155.7 852.3 164.3 color -1;
           terminals
            input 848 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 848 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 844.8 460.8 851.2 467.2 color -1 fill 0;
            ellipse 843.7 459.7 852.3 468.3 color -1;
           terminals
            input 848 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 680 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 680 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 824 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 824 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 680 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 680 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 824 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 824 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 824 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 824 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 824 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 824 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 896 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 46.6];
          end;
          icon bg bottom
           figures
            rectangle 880 24 912 56 color 0 fill 15132390;
            text 'ò' 893.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 896 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 11.5];
          end;
          icon bg bottom
           figures
            rectangle 880 544 912 576 color 0 fill 15132390;
            text 'ò' 893.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 400 360;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 848 40;
         Splitter9\output -> X_B2\input 848 560;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Interface_01 216 104
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 88 256 120 color 0 fill 55295;
         text 'name' 216 104 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 92.4 48;
         plug V_B10 343.1 48;
         plug input 215 37.5;
         plug input1 200 384;
         plug p 320 384;
         plug p1 88 384;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 136 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 98.9 88.3 173.1 135.7 color 0 fill 11788799;
            text 'MTF' 136 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 128 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 128 368 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         X_B2 392 96
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 4.282075];
          end;
          icon bg left
           figures
            rectangle 376 80 408 112 color 0 fill 15132390;
            text 'ò' 389.3 96 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\flow -> X_B2\input;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_02 216 328
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 312 256 344 color 0 fill 55295;
         text 'name' 216 328 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 320;
         plug V_B10 304 312;
         plug input 213.2 191;
         plug input1 213 415.5;
         plug p 304 352;
         plug p1 128 368;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_03 216 560
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 544 256 576 color 0 fill 55295;
         text 'name' 216 560 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 560;
         plug V_B10 304 552;
         plug input 215.2 431;
         plug input1 214.4 647.5;
         plug p 312 600;
         plug p1 136 600;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_04 216 808
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 792 256 824 color 0 fill 55295;
         text 'name' 216 808 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 792;
         plug V_B10 304 784;
         plug input 215.5 671;
         plug input1 214.9 887.5;
         plug p 304 824;
         plug p1 128 840;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_05 220 1048
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 1032 264 1064 color 0 fill 55295;
         text 'name' 224 1048 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 1032;
         plug V_B10 304 1024;
         plug input 215.7 895;
         plug input1 215.2 1143.5;
         plug p 304 1072;
         plug p1 136 1064;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      plug v_B10_OUT 336 1288;
      plug Cardan_OUT 216 1288;
      plug om_B10_OUT 88 1288;
      plug Cardan_IN 216 32.5;
      plug V_B10_IN 352 40;
      plug Om_B10_IN 88 40;
     end;
     connections
      Cardan_IN -> Interface_01\input;
      Element_02\output -> Interface_02\input;
      Element_02\output1 -> Interface_01\input1;
      Element_02\P1 => Interface_02\Om_B10 136 240 136 320;
      Element_02\p1 => Interface_02\V_B10 312 232 312 304;
      Element_03\output -> Interface_03\input;
      Element_03\output1 -> Interface_02\input1;
      Element_03\P1 => Interface_03\Om_B10 136 480 136 560;
      Element_03\p1 => Interface_03\V_B10 304 480 304 552;
      Element_04\output -> Interface_04\input;
      Element_04\output1 -> Interface_03\input1;
      Element_04\P1 => Interface_04\Om_B10 136 712 136 792;
      Element_04\p1 => Interface_04\V_B10 304 712 304 784;
      Element_05\output -> Interface_05\input;
      Element_05\output1 -> Interface_04\input1;
      Element_05\P1 => Interface_05\Om_B10 136 952 136 1032;
      Element_05\p1 => Interface_05\V_B10 304 952 304 1024;
      Element_06\output -> Cardan_OUT;
      Element_06\output1 -> Interface_05\input1;
      Element_06\P1 => om_B10_OUT 104 1208;
      Element_06\p1 => v_B10_OUT 312 1208;
      Interface_01\p => Element_02\p 312 128 312 192;
      Interface_01\p1 => Element_02\P 120 112 120 176;
      Interface_02\p => Element_03\p 304 352 304 424;
      Interface_02\p1 => Element_03\P 128 368 128 440;
      Interface_03\p => Element_04\p 312 600 312 664;
      Interface_03\p1 => Element_04\P 136 600 136 664;
      Interface_04\p => Element_05\p 304 824 304 896;
      Interface_04\p1 => Element_05\P 128 840 128 912;
      Interface_05\p => Element_06\p 304 1072 304 1160;
      Interface_05\p1 => Element_06\P 136 1064 136 1168;
      Om_B10_IN => Interface_01\Om_B10;
      V_B10_IN => Interface_01\V_B10;
     end;
    implementation_end;
   FEB_02 248 280
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
    type Submodel
     ports
      power in Om_B10_IN [3,1];
      power in V_B10_IN [3,1];
      signal in Cardan_IN [3,1];
      power out om_B10_OUT [3,1];
      signal out Cardan_OUT [3,1];
      power out v_B10_OUT [3,1];
    end;
    implementation bg
     submodels
      Element_07 216 208
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 408 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 384 304 432 336 color 0 fill 15132390;
            text 'Cardan' 408 320 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 232
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 232 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 448 416
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 448 416 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 448 232
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 448 232 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 480 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 464 344.1 496 375.9 color 0 fill 15132390;
            text 'R01' 480 360 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 383 267.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 383 267.5 color 0 21 bold;
           terminals
            P 400 263.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 400 384
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 400 384 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 280
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 280 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 408
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 408 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 352;
         plug p1 448 560;
         plug output1 560 568;
         plug output 560 24;
         plug P 176 248;
         plug p 448 24;
         OneJunction 800 80
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 800 80 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 800 576
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 800 576 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 520 432
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 587 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 565 138 609.1 198 color 0 fill 14013909;
            text 'R01' 587.1 168 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 592 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 570 442 614 502 color 0 fill 14013909;
            text 'R01' 592 472 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 619.1 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 597.1 290 641.1 350 color 0 fill 14013909;
            text 'R01' 619.1 320 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 331.1 152.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 315.1 136.2 347.1 168 color 0 fill 15132390;
            line 326.8 141 326.8 163 color 16711680 width 2;
            line 337.9 138.3 337.9 164 color 0;
            line 321.9 140.6 340.1 140.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 331.1 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 315.1 472.1 347.1 503.9 color 0 fill 15132390;
            line 326.8 476.9 326.8 498.9 color 16711680 width 2;
            line 337.9 474.2 337.9 499.9 color 0;
            line 321.9 476.5 340.1 476.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 728 80
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 728 80 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 728 576
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 728 576 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 364.8 939.2 371.2 color -1 fill 0;
            ellipse 931.7 363.7 940.3 372.3 color -1;
           terminals
            input 936 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 560 320
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 316.8 563.2 323.2 color -1 fill 0;
            ellipse 555.7 315.7 564.3 324.3 color -1;
           terminals
            input 560 320 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 560 232
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 228.8 563.2 235.2 color -1 fill 0;
            ellipse 555.7 227.7 564.3 236.3 color -1;
           terminals
            input 560 232 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 560 400
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 396.8 563.2 403.2 color -1 fill 0;
            ellipse 555.7 395.7 564.3 404.3 color -1;
           terminals
            input 560 400 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 824 168
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 820.8 164.8 827.2 171.2 color -1 fill 0;
            ellipse 819.7 163.7 828.3 172.3 color -1;
           terminals
            input 824 168 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter8 360 320
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 316.8 363.2 323.2 color -1 fill 0;
            ellipse 355.7 315.7 364.3 324.3 color -1;
           terminals
            input 360 320 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 824 472
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 820.8 468.8 827.2 475.2 color -1 fill 0;
            ellipse 819.7 467.7 828.3 476.3 color -1;
           terminals
            input 824 472 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 648 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 168 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 448 168
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 448 168 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 800 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 800 168 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 448 472
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 448 472 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 648 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 472 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 800 472
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 800 472 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 320
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 320 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 448 272
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 448 272 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 800 8
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 800 8 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 800 648
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 800 648 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 331 232.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 299 208.6 363 255.6 color 0 fill 12895428;
            text 'w X rA/G' 331 232.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 331 416
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 299 392.6 363.1 439.5 color 0 fill 12895428;
            text 'w X rB/G' 331.1 416.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 331.1 320.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 331.1 320.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 872 48
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 55.92];
          end;
          icon bg bottom
           figures
            rectangle 856 32 888 64 color 0 fill 15132390;
            text 'ò' 869.3 48 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 872 568
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 7.5];
          end;
          icon bg bottom
           figures
            rectangle 856 552 888 584 color 0 fill 15132390;
            text 'ò' 869.3 568 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 352
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 336 872 368 color 0 fill 15132390;
            text '∫' 853.3 352 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 368;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 824 48;
         Splitter8\output -> Body3_213\w;
         Splitter8\output -> Gain\input 400 360;
         Splitter9\output -> X_B2\input 824 568;
         vA_0\P => vA_2\P;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 560 272;
         w_1\outp -> Splitter8\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_08 216 448
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 432 256 464 color 0 fill 16777152;
         text 'name' 216 448 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 416 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 392 312 440 344 color 0 fill 15132390;
            text 'Cardan' 416 328 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 240
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 240 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 456 424
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 456 424 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 456 240
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 456 240 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 496 368
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 480 352.1 512 383.9 color 0 fill 15132390;
            text 'R01' 496 368 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 343 275.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 343 275.9 color 0 21 bold;
           terminals
            P 360 271.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 360 400
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 360 400 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 288
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 288 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 416
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 416 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 368;
         plug p1 456 592;
         plug output1 592 592;
         plug output 592 16;
         plug P 168 280;
         plug p 456 16;
         OneJunction 680 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 680 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 680 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 680 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 232 384
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 232 384 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 536 440
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 627 176
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 605 146 649.1 206 color 0 fill 14013909;
            text 'R01' 627.1 176 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 624 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 602 450 646 510 color 0 fill 14013909;
            text 'R01' 624 480 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 651.1 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 629.1 298 673.1 358 color 0 fill 14013909;
            text 'R01' 651.1 328 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 291.1 160.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 275.1 144.2 307.1 176 color 0 fill 15132390;
            line 286.8 149 286.8 171 color 16711680 width 2;
            line 297.9 146.3 297.9 172 color 0;
            line 281.9 148.6 300.1 148.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 291.1 496
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 275.1 480.1 307.1 511.9 color 0 fill 15132390;
            line 286.8 484.9 286.8 506.9 color 16711680 width 2;
            line 297.9 482.2 297.9 507.9 color 0;
            line 281.9 484.5 300.1 484.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 608 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 608 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 608 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 608 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 376
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 372.8 939.2 379.2 color -1 fill 0;
            ellipse 931.7 371.7 940.3 380.3 color -1;
           terminals
            input 936 376 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 592 328
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 324.8 595.2 331.2 color -1 fill 0;
            ellipse 587.7 323.7 596.3 332.3 color -1;
           terminals
            input 592 328 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 592 240
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 236.8 595.2 243.2 color -1 fill 0;
            ellipse 587.7 235.7 596.3 244.3 color -1;
           terminals
            input 592 240 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 592 408
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 404.8 595.2 411.2 color -1 fill 0;
            ellipse 587.7 403.7 596.3 412.3 color -1;
           terminals
            input 592 408 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 352 328
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 324.8 355.2 331.2 color -1 fill 0;
            ellipse 347.7 323.7 356.3 332.3 color -1;
           terminals
            input 352 328 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 704 176
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 700.8 172.8 707.2 179.2 color -1 fill 0;
            ellipse 699.7 171.7 708.3 180.3 color -1;
           terminals
            input 704 176 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 704 480
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 700.8 476.8 707.2 483.2 color -1 fill 0;
            ellipse 699.7 475.7 708.3 484.3 color -1;
           terminals
            input 704 480 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 680 176
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 680 176 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 456 176
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 456 176 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 456 480
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 456 480 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 680 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 680 480 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 328
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 328 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 456 280
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 456 280 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 680 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 680 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 680 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 680 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 291 240.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 259 216.6 323 263.6 color 0 fill 12895428;
            text 'w X rA/G' 291 240.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 291 424
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 259 400.6 323.1 447.5 color 0 fill 12895428;
            text 'w X rB/G' 291.1 424.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 291.1 328.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 291.1 328.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 752 56
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 65.24];
          end;
          icon bg bottom
           figures
            rectangle 736 40 768 72 color 0 fill 15132390;
            text 'ò' 749.3 56 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 752 576
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 8.5];
          end;
          icon bg bottom
           figures
            rectangle 736 560 768 592 color 0 fill 15132390;
            text 'ò' 749.3 576 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 360
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 344 872 376 color 0 fill 15132390;
            text '∫' 853.3 360 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 376;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 392 368;
         Splitter7\output -> X_A\input 704 56;
         Splitter9\output -> X_B1\input 704 576;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 568 280;
         w_1\outp -> Splitter5\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_09 216 688
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 512 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 496 336.1 528 367.9 color 0 fill 15132390;
            text 'R01' 512 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 176 168;
         plug p1 440 624;
         plug output1 608 616;
         plug output 608 48;
         plug P 176 384;
         plug p 440 56;
         OneJunction 848 88
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 848 88 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 848 584
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 848 584 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 552 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 130 657.1 190 color 0 fill 14013909;
            text 'R01' 635.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 640 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 618 434 662 494 color 0 fill 14013909;
            text 'R01' 640 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 667.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 645.1 282 689.1 342 color 0 fill 14013909;
            text 'R01' 667.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 776 88
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 776 88 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 776 584
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 776 584 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 608 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 308.8 611.2 315.2 color -1 fill 0;
            ellipse 603.7 307.7 612.3 316.3 color -1;
           terminals
            input 608 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 608 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 220.8 611.2 227.2 color -1 fill 0;
            ellipse 603.7 219.7 612.3 228.3 color -1;
           terminals
            input 608 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 608 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 388.8 611.2 395.2 color -1 fill 0;
            ellipse 603.7 387.7 612.3 396.3 color -1;
           terminals
            input 608 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 872 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 868.8 156.8 875.2 163.2 color -1 fill 0;
            ellipse 867.7 155.7 876.3 164.3 color -1;
           terminals
            input 872 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 872 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 868.8 460.8 875.2 467.2 color -1 fill 0;
            ellipse 867.7 459.7 876.3 468.3 color -1;
           terminals
            input 872 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 696 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 848 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 848 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 696 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 848 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 848 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 848 16
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 848 16 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 848 656
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 848 656 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 920 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 74.56];
          end;
          icon bg bottom
           figures
            rectangle 904 24 936 56 color 0 fill 15132390;
            text 'ò' 917.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 920 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 9.5];
          end;
          icon bg bottom
           figures
            rectangle 904 544 936 576 color 0 fill 15132390;
            text 'ò' 917.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 392 352;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 872 40;
         Splitter9\output -> X_B2\input 872 560;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_10 216 912
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 896 256 928 color 0 fill 16777152;
         text 'name' 216 912 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         MSe 824 448
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\MSe.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:12:33</TimeStamp>
</Description>
</Information>';
          type MSe
           ports
            power out p [3,1];
            signal in effort [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg bottom
           figures
            text 'MSe' 824 448 color 0 18 bold;
          end;
          implementation eq
variables
	real flow[3,1];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
         plug p1 432 712;
         plug output1 496 712;
         plug output 488 40;
         plug P 176 288;
         plug p 440 40;
         plug P1 184 328;
         OneJunction 688 88
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 88 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 584
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 584 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Pulse 896 448
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\SignalGenerator-Pulse.emx</LibraryPath>
  <TimeStamp>2007-9-27 16:1:38</TimeStamp>
</Description>';
          type 'SignalGenerator-Pulse'
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 880.1 432 911.9 464 color 0 fill 15132390;
            line 891.7 446.4 897.4 446.4 color 16711680 width 2;
            line 883 458.2 909 458.2 color 0;
            line 886 458.1 891.6 458.1 891.6 446.5 color 16711680 width 2;
            line 886 440.6 886 461 color 0;
            line 906.2 458.2 897.4 458.1 897.4 446.5 color 16711680 width 2;
          end;
          implementation eq
parameters
	real start_time = 0.1 {s};
	real stop_time = 0.2 {s};
	real amplitude = 10000 {N};
variables
	boolean hidden change;
equations
	"calculate at least at the start and stop time"
	change = timeevent (start_time) or timeevent (stop_time);

	"calculate the block signal"
	output[1,1] = amplitude * (step (start_time) - step (stop_time));
	output[2,1] = amplitude * (step (start_time) - step (stop_time));
	output[3,1] = 0;
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 88
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 88 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 584
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 584 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 16
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 16 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 656
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 656 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 83.88];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 10.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         MSe\p => vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         Pulse\output -> MSe\effort;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_11 216 1176
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_C1 1152 360
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 1152 360 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 488 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 472 336.1 504 367.9 color 0 fill 15132390;
            text 'R01' 488 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         Gyro2 1072 208
          type EJS1
           ports
            power none P [3,1];
            signal in omega [3,1];
            signal in m [3,3];
           restrictions
            causality fixed out P;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:

variables
	real	W[3, 3];
equations
	W[1, 1] = 0;
	W[1, 2] = -omega[3];
	W[1, 3] = omega[2];
	W[2, 1] = omega[3];
	W[2, 2] = 0;
	W[2, 3] = -omega[1];
	W[3, 1] = -omega[2];
	W[3, 2] = omega[1];
	W[3, 3] = 0;
	P.e = W * m * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         K_Par_Rot1 1240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'C-3'
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 1240 424 color 0 18 bold;
          end;
          implementation eq
parameters
	real K[3,3] = [10000000, 0, 0;0, 10000000, 0;0, 0, 10000000];
equations
    state = int(p.f);
    p.e = K *state;
implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         mc1 1072 128
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\I-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:14</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'I-3'
           ports
            power in p [3,1];
            signal out state [3,1];
            signal out m [3,3];
           restrictions
            causality preferred in p;
          end;
          icon bg top
           figures
            text 'I' 1072 128 color 0 18 bold;
          end;
          implementation eq
parameters
	real i[3,3] = [100, 0, 0;0, 100, 0;0, 0, 100];
equations
    state = int(p.e);
    p.f = inverse(i) * state;
m = i;implementation_end;
         plug p 440 24;
         plug output 592 16;
         plug output1 592 576;
         plug p1 440 576;
         plug P 192 360;
         plug P1 168 216;
         OneJunction 824 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 824 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 824 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 824 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction2 1240 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 1240 360 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 528 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 619 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 597 130 641.1 190 color 0 fill 14013909;
            text 'R01' 619.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 624 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 602 434 646 494 color 0 fill 14013909;
            text 'R01' 624 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 651.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 629.1 282 673.1 342 color 0 fill 14013909;
            text 'R01' 651.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 752 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 752 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 752 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 752 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         R_Par_Rot1 1240 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'R-3'
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 1240 304 color 0 18 bold;
          end;
          implementation eq
parameters
	real r[3,3] = [1e5, 0, 0;0, 1e5, 0;0, 0, 1e5];
equations					
	p.e = r * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 592 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 308.8 595.2 315.2 color -1 fill 0;
            ellipse 587.7 307.7 596.3 316.3 color -1;
           terminals
            input 592 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 592 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 220.8 595.2 227.2 color -1 fill 0;
            ellipse 587.7 219.7 596.3 228.3 color -1;
           terminals
            input 592 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 592 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 588.8 388.8 595.2 395.2 color -1 fill 0;
            ellipse 587.7 387.7 596.3 396.3 color -1;
           terminals
            input 592 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 848 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 844.8 156.8 851.2 163.2 color -1 fill 0;
            ellipse 843.7 155.7 852.3 164.3 color -1;
           terminals
            input 848 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 848 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 844.8 460.8 851.2 467.2 color -1 fill 0;
            ellipse 843.7 459.7 852.3 468.3 color -1;
           terminals
            input 848 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 680 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 680 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 824 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 824 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 680 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 680 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 824 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 824 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         VC1 1152 128
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg
           figures
            text '1' 1152 128 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 824 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 824 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 824 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 824 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         XC1 1088 360
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTX1
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          implementation bg
           submodels
            CrossPr 304 256
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;

implementation_end;
            MTF_act1 304 376
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 304 376 color 0 'Courier New' 18 bold;
              terminals
               p1 280 376 fixed;
               p2 328 376 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 608 376;
            plug PowIn 40 376;
            plug X 304 128;
            PowerIn 128 376
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 128 376 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 472 376
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 472 376 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
           end;
           connections
            CrossPr\Fmt -> MTF_act1\r;
            MTF_act1\p2 => PowerOut\P;
            PowerIn\P => MTF_act1\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            X -> CrossPr\X;
           end;
           figures
            text 'This block turns the position vector into
a skew-symmetric matrix.  Multiplying
skew matrix and angular velocity is the 
same as taking the cross product w X r.' 440 256 color 0;
          implementation_end;
         X_A1 896 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 93.2];
          end;
          icon bg bottom
           figures
            rectangle 880 24 912 56 color 0 fill 15132390;
            text 'ò' 893.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 896 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 11.5];
          end;
          icon bg bottom
           figures
            rectangle 880 544 912 576 color 0 fill 15132390;
            text 'ò' 893.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_C1 1088 456
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg
           figures
            rectangle 1072 440.1 1104 471.9 color 0 fill 15132390;
            line 1083.7 467.1 1083.7 445.2 color 16711680 width 2;
            line 1094.8 469.8 1094.8 444.1 color 0;
            line 1078.8 467.6 1097 467.6 color 0;
          end;
          implementation eq
//    Constant signal source

parameters
	real mcrc = 0.1;

variables
	real	global rB_Gp[3,1];	//  amplitude of output signal

equations
	output = [mcrc; 0; rB_Gp[3]];
implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         F_C1\P => OneJunction2\p;
         F_C1\P => VC1\P;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         mc1\m -> Gyro2\m;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         OneJunction2\p => K_Par_Rot1\p;
         OneJunction2\p => R_Par_Rot1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 400 360;
         Splitter11\output -> Gyro2\omega 672 200;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 848 40;
         Splitter9\output -> X_B2\input 848 560;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         VC1\P => Gyro2\P;
         VC1\P => mc1\p;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => F_C1\P 944 168;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         w_1\P => XC1\PowIn 200 480 200 664 952 664;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_C1\output -> XC1\X;
         X_G\output -> Splitter10\input;
         XC1\PowOut => F_C1\P;
        end;
        figures
         text 'vC = vG + vC/G' 1160 456 color 0 16;
         text 'vC/G = w X rC/G' 1152 392 color 0 16;
       implementation_end;
      Interface_06 216 104
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 88 256 120 color 0 fill 55295;
         text 'name' 216 104 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 92.4 48;
         plug V_B10 343.1 48;
         plug input 215 37.5;
         plug input1 167.5 175.5;
         plug p 312 128;
         plug p1 120 112;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         X_B2 384 88
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 4.282075];
          end;
          icon bg left
           figures
            rectangle 368 72 400 104 color 0 fill 15132390;
            text 'ò' 381.3 88 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\flow -> X_B2\input;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_07 216 328
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 312 256 344 color 0 fill 55295;
         text 'name' 216 328 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 320;
         plug V_B10 304 312;
         plug input 213.2 191;
         plug input1 213 415.5;
         plug p 304 352;
         plug p1 128 368;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_08 216 560
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 544 256 576 color 0 fill 55295;
         text 'name' 216 560 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 560;
         plug V_B10 304 552;
         plug input 215.2 431;
         plug input1 214.4 647.5;
         plug p 312 600;
         plug p1 136 600;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_09 216 808
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 792 256 824 color 0 fill 55295;
         text 'name' 216 808 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 792;
         plug V_B10 304 784;
         plug input 215.5 671;
         plug input1 214.9 887.5;
         plug p 304 824;
         plug p1 128 840;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_10 220 1048
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 1032 264 1064 color 0 fill 55295;
         text 'name' 224 1048 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 1032;
         plug V_B10 304 1024;
         plug input 215.7 895;
         plug input1 215.2 1143.5;
         plug p 304 1072;
         plug p1 136 1064;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      plug v_B10_OUT 336 1288;
      plug Cardan_OUT 216 1288;
      plug om_B10_OUT 88 1288;
      plug Cardan_IN 216 32.5;
      plug V_B10_IN 352 40;
      plug Om_B10_IN 88 40;
     end;
     connections
      Cardan_IN -> Interface_06\input;
      Element_07\output -> Interface_07\input;
      Element_07\output1 -> Interface_06\input1;
      Element_07\P1 => Interface_07\Om_B10 136 240 136 320;
      Element_07\p1 => Interface_07\V_B10 312 232 312 304;
      Element_08\output -> Interface_08\input;
      Element_08\output1 -> Interface_07\input1;
      Element_08\P1 => Interface_08\Om_B10 136 480 136 560;
      Element_08\p1 => Interface_08\V_B10 304 480 304 552;
      Element_09\output -> Interface_09\input;
      Element_09\output1 -> Interface_08\input1;
      Element_09\P1 => Interface_09\Om_B10 136 712 136 792;
      Element_09\p1 => Interface_09\V_B10 304 712 304 784;
      Element_10\output -> Interface_10\input;
      Element_10\output1 -> Interface_09\input1;
      Element_10\P1 => Interface_10\Om_B10 136 952 136 1032;
      Element_10\p1 => Interface_10\V_B10 304 952 304 1024;
      Element_11\output -> Cardan_OUT;
      Element_11\output1 -> Interface_10\input1;
      Element_11\P1 => om_B10_OUT 104 1208;
      Element_11\p1 => v_B10_OUT 312 1208;
      Interface_06\p => Element_07\p 312 128 312 192;
      Interface_06\p1 => Element_07\P 120 112 120 176;
      Interface_07\p => Element_08\p 304 352 304 424;
      Interface_07\p1 => Element_08\P 128 368 128 440;
      Interface_08\p => Element_09\p 312 600 312 664;
      Interface_08\p1 => Element_09\P 136 600 136 664;
      Interface_09\p => Element_10\p 304 824 304 896;
      Interface_09\p1 => Element_10\P 128 840 128 912;
      Interface_10\p => Element_11\p 304 1072 304 1160;
      Interface_10\p1 => Element_11\P 136 1064 136 1168;
      Om_B10_IN => Interface_06\Om_B10;
      V_B10_IN => Interface_06\V_B10;
     end;
    implementation_end;
   FEB_03 248 336
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
    type Submodel
     ports
      power in Om_B10_IN [3,1];
      power in V_B10_IN [3,1];
      signal in Cardan_IN [3,1];
      power out om_B10_OUT [3,1];
      signal out Cardan_OUT [3,1];
      power out v_B10_OUT [3,1];
    end;
    implementation bg
     submodels
      Element_12 216 216
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 200 256 232 color 0 fill 16777152;
         text 'name' 216 216 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 136 240;
         plug p1 440 632;
         plug output1 488 632;
         plug output 488 24;
         plug P 120 176;
         plug p 440 24;
         OneJunction 688 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 102.52];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 12.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         output1 <- Splitter4\output;
         p1 <= vB_1\p;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_13 216 456
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 496 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 480 336.1 512 367.9 color 0 fill 15132390;
            text 'R01' 496 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 360;
         plug p1 440 576;
         plug output1 584 576;
         plug output 584 32;
         plug P 152 272;
         plug p 440 32;
         OneJunction 832 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 832 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 832 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 832 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 536 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 611 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 589 130 633.1 190 color 0 fill 14013909;
            text 'R01' 611.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 616 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 594 434 638 494 color 0 fill 14013909;
            text 'R01' 616 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 643.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 621.1 282 665.1 342 color 0 fill 14013909;
            text 'R01' 643.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 760 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 760 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 760 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 760 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 344 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 340.8 308.8 347.2 315.2 color -1 fill 0;
            ellipse 339.7 307.7 348.3 316.3 color -1;
           terminals
            input 344 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 584 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 580.8 308.8 587.2 315.2 color -1 fill 0;
            ellipse 579.7 307.7 588.3 316.3 color -1;
           terminals
            input 584 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 584 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 580.8 220.8 587.2 227.2 color -1 fill 0;
            ellipse 579.7 219.7 588.3 228.3 color -1;
           terminals
            input 584 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 584 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 580.8 388.8 587.2 395.2 color -1 fill 0;
            ellipse 579.7 387.7 588.3 396.3 color -1;
           terminals
            input 584 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 856 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 852.8 156.8 859.2 163.2 color -1 fill 0;
            ellipse 851.7 155.7 860.3 164.3 color -1;
           terminals
            input 856 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 856 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 852.8 460.8 859.2 467.2 color -1 fill 0;
            ellipse 851.7 459.7 860.3 468.3 color -1;
           terminals
            input 856 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 672 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 672 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 832 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 832 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 672 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 672 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 832 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 832 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 832 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 832 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 832 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 832 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 319.9 407.9
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 287.9 384.5 352 431.4 color 0 fill 12895428;
            text 'w X rB/G' 320 408 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A1 904 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 111.84];
          end;
          icon bg bottom
           figures
            rectangle 888 24 920 56 color 0 fill 15132390;
            text 'ò' 901.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 904 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 13.5];
          end;
          icon bg bottom
           figures
            rectangle 888 544 920 576 color 0 fill 15132390;
            text 'ò' 901.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 392 352;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 856 40;
         Splitter9\output -> X_B2\input 856 560;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_14 216 688
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 672 256 704 color 0 fill 16777152;
         text 'name' 216 688 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 168 328;
         plug p1 440 664;
         plug output1 488 664;
         plug output 488 32;
         plug P 168 280;
         plug p 440 32;
         OneJunction 688 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 121.16];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 14.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_15 216 928
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 352
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 336.1 520 367.9 color 0 fill 15132390;
            text 'R01' 504 352 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 80 640;
         plug p1 440 688;
         plug output1 608 688;
         plug output 608 24;
         plug P 216 184;
         plug p 440 24;
         OneJunction 840 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 840 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 840 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 840 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 424
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 130 657.1 190 color 0 fill 14013909;
            text 'R01' 635.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 640 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 618 434 662 494 color 0 fill 14013909;
            text 'R01' 640 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 667.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 645.1 282 689.1 342 color 0 fill 14013909;
            text 'R01' 667.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 768 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 768 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 768 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 768 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 608 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 308.8 611.2 315.2 color -1 fill 0;
            ellipse 603.7 307.7 612.3 316.3 color -1;
           terminals
            input 608 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 608 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 220.8 611.2 227.2 color -1 fill 0;
            ellipse 603.7 219.7 612.3 228.3 color -1;
           terminals
            input 608 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 608 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 388.8 611.2 395.2 color -1 fill 0;
            ellipse 603.7 387.7 612.3 396.3 color -1;
           terminals
            input 608 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 864 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 860.8 156.8 867.2 163.2 color -1 fill 0;
            ellipse 859.7 155.7 868.3 164.3 color -1;
           terminals
            input 864 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 864 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 860.8 460.8 867.2 467.2 color -1 fill 0;
            ellipse 859.7 459.7 868.3 468.3 color -1;
           terminals
            input 864 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 696 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 840 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 840 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 696 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 840 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 840 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 840 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 840 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 840 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 840 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 696 216
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 130.48];
          end;
          icon bg left
           figures
            rectangle 680 200 712 232 color 0 fill 15132390;
            text 'ò' 693.3 216 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_A1 912 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 130.48];
          end;
          icon bg bottom
           figures
            rectangle 896 24 928 56 color 0 fill 15132390;
            text 'ò' 909.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 696 400
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 15.5];
          end;
          icon bg left
           figures
            rectangle 680 384 712 416 color 0 fill 15132390;
            text 'ò' 693.3 400 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 912 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 15.5];
          end;
          icon bg bottom
           figures
            rectangle 896 544 928 576 color 0 fill 15132390;
            text 'ò' 909.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 392 352;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 864 40;
         Splitter9\output -> X_B2\input 864 560;
         vA_0\outp -> X_A\input;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> X_B1\input;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_16 216 1176
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 1160 256 1192 color 0 fill 16777152;
         text 'name' 216 1176 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 200 344;
         plug p1 464 696;
         plug output1 600 704;
         plug output 600 24;
         plug P 208 280;
         plug p 464 32;
         OneJunction 688 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction2 688 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 139.8];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 16.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction2\p => RWB1\p;
         OneJunction2\p => vB_2\P;
         OneJunction2\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Interface_11 216 112
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 96 256 128 color 0 fill 55295;
         text 'name' 216 112 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 92.4 48;
         plug V_B10 343.1 48;
         plug input 215 37.5;
         plug input1 182 199;
         plug p 312 128;
         plug p1 120 112;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         X_B2 384 88
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 4.282075];
          end;
          icon bg left
           figures
            rectangle 368 72 400 104 color 0 fill 15132390;
            text 'ò' 381.3 88 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\flow -> X_B2\input;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_12 216 328
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 312 256 344 color 0 fill 55295;
         text 'name' 216 328 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 128 24;
         plug V_B10 272 24;
         plug input 200 32;
         plug input1 208 424;
         plug p 304 352;
         plug p1 128 368;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_13 216 568
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 552 256 584 color 0 fill 55295;
         text 'name' 216 568 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 560;
         plug V_B10 304 552;
         plug input 215.2 439;
         plug input1 215.4 671;
         plug p 312 600;
         plug p1 136 600;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_14 216 792
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 776 256 808 color 0 fill 55295;
         text 'name' 216 792 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 792;
         plug V_B10 304 784;
         plug input 215.5 671;
         plug input1 215.6 919;
         plug p 304 824;
         plug p1 128 840;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_15 220 1064
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 1048 264 1080 color 0 fill 55295;
         text 'name' 224 1064 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 1032;
         plug V_B10 304 1024;
         plug input 215.7 911;
         plug input1 215.7 1159;
         plug p 304 1072;
         plug p1 136 1064;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      plug v_B10_OUT 336 1288;
      plug Cardan_OUT 216 1288;
      plug om_B10_OUT 88 1288;
      plug Cardan_IN 216 32.5;
      plug V_B10_IN 352 40;
      plug Om_B10_IN 88 40;
     end;
     connections
      Cardan_IN -> Interface_11\input;
      Element_12\output -> Interface_12\input;
      Element_12\output1 -> Interface_11\input1;
      Element_12\P1 => Interface_12\Om_B10 136 240 136 320;
      Element_12\p1 => Interface_12\V_B10 304 240 304 312;
      Element_13\output -> Interface_13\input;
      Element_13\output1 -> Interface_12\input1;
      Element_13\P1 => Interface_13\Om_B10 136 480 136 560;
      Element_13\p1 => Interface_13\V_B10 304 480 304 552;
      Element_14\output -> Interface_14\input;
      Element_14\output1 -> Interface_13\input1;
      Element_14\P1 => Interface_14\Om_B10 136 712 136 792;
      Element_14\p1 => Interface_14\V_B10 304 712 304 784;
      Element_15\output -> Interface_15\input;
      Element_15\output1 -> Interface_14\input1;
      Element_15\P1 => Interface_15\Om_B10 136 952 136 1032;
      Element_15\p1 => Interface_15\V_B10 304 952 304 1024;
      Element_16\output -> Cardan_OUT;
      Element_16\output1 -> Interface_15\input1;
      Element_16\P1 => om_B10_OUT 104 1208;
      Element_16\p1 => v_B10_OUT 312 1208;
      Interface_11\p => Element_12\p 312 128 312 192;
      Interface_11\p1 => Element_12\P 120 112 120 176;
      Interface_12\p => Element_13\p 304 352 304 424;
      Interface_12\p1 => Element_13\P 128 368 128 440;
      Interface_13\p => Element_14\p 312 600 312 664;
      Interface_13\p1 => Element_14\P 136 600 136 664;
      Interface_14\p => Element_15\p 304 824 304 896;
      Interface_14\p1 => Element_15\P 128 840 128 912;
      Interface_15\p => Element_16\p 304 1072 304 1160;
      Interface_15\p1 => Element_16\P 136 1064 136 1168;
      Om_B10_IN => Interface_11\Om_B10;
      V_B10_IN => Interface_11\V_B10;
     end;
    implementation_end;
   FEB_04 248 400
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
    type Submodel
     ports
      power in Om_B10_IN [3,1];
      power in V_B10_IN [3,1];
      signal in Cardan_IN [3,1];
      power out om_B10_OUT [3,1];
      signal out Cardan_OUT [3,1];
      power out v_B10_OUT [3,1];
    end;
    implementation bg
     submodels
      Element_17 216 216
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 480 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 464 344.1 496 375.9 color 0 fill 15132390;
            text 'R01' 480 360 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 160 360;
         plug p1 440 576;
         plug output1 560 576;
         plug output 560 24;
         plug P 160 232;
         plug p 440 32;
         OneJunction 816 72
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 72 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 816 568
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 568 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 520 432
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 587 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 565 130 609.1 190 color 0 fill 14013909;
            text 'R01' 587.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 592 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 570 434 614 494 color 0 fill 14013909;
            text 'R01' 592 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 619.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 597.1 282 641.1 342 color 0 fill 14013909;
            text 'R01' 619.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 744 72
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 72 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 744 568
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 568 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 560 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 308.8 563.2 315.2 color -1 fill 0;
            ellipse 555.7 307.7 564.3 316.3 color -1;
           terminals
            input 560 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 560 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 220.8 563.2 227.2 color -1 fill 0;
            ellipse 555.7 219.7 564.3 228.3 color -1;
           terminals
            input 560 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 560 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 556.8 388.8 563.2 395.2 color -1 fill 0;
            ellipse 555.7 387.7 564.3 396.3 color -1;
           terminals
            input 560 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 840 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 156.8 843.2 163.2 color -1 fill 0;
            ellipse 835.7 155.7 844.3 164.3 color -1;
           terminals
            input 840 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 840 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 460.8 843.2 467.2 color -1 fill 0;
            ellipse 835.7 459.7 844.3 468.3 color -1;
           terminals
            input 840 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 648 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 816 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 816 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 648 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 648 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 816 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 816 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 816 0
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 0 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 816 640
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 640 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 320 224
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 288 200.5 352 247.5 color 0 fill 12895428;
            text 'w X rA/G' 320 224.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 648 216
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 149.12];
          end;
          icon bg left
           figures
            rectangle 632 200 664 232 color 0 fill 15132390;
            text 'ò' 645.3 216 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_A1 888 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 149.12];
          end;
          icon bg bottom
           figures
            rectangle 872 24 904 56 color 0 fill 15132390;
            text 'ò' 885.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 648 400
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 17.5];
          end;
          icon bg left
           figures
            rectangle 632 384 664 416 color 0 fill 15132390;
            text 'ò' 645.3 400 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 888 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 17.5];
          end;
          icon bg bottom
           figures
            rectangle 872 544 904 576 color 0 fill 15132390;
            text 'ò' 885.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 400 360;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 840 40;
         Splitter9\output -> X_B2\input 840 560;
         vA_0\outp -> X_A\input;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> X_B1\input;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_18 216 456
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 440 256 472 color 0 fill 16777152;
         text 'name' 216 456 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 136 280;
         plug p1 440 592;
         plug output1 488 592;
         plug output 488 32;
         plug P 128 440;
         plug p 440 40;
         OneJunction 688 80
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 80 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 576
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 576 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 80
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 80 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 576
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 576 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 8
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 8 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 648
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 648 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 158.44];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 18.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         p => vA_1\p;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_19 216 688
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 480 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 464 344.1 496 375.9 color 0 fill 15132390;
            text 'R01' 480 360 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 144 328;
         plug p1 440 600;
         plug output1 608 584;
         plug output 608 72;
         plug P 144 280;
         plug p 440 80;
         OneJunction 816 80
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 80 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 816 576
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 576 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 520 432
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 130 657.1 190 color 0 fill 14013909;
            text 'R01' 635.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 640 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 618 434 662 494 color 0 fill 14013909;
            text 'R01' 640 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 667.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 645.1 282 689.1 342 color 0 fill 14013909;
            text 'R01' 667.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 744 80
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 80 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 744 576
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 576 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 608 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 308.8 611.2 315.2 color -1 fill 0;
            ellipse 603.7 307.7 612.3 316.3 color -1;
           terminals
            input 608 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 608 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 220.8 611.2 227.2 color -1 fill 0;
            ellipse 603.7 219.7 612.3 228.3 color -1;
           terminals
            input 608 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 608 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 604.8 388.8 611.2 395.2 color -1 fill 0;
            ellipse 603.7 387.7 612.3 396.3 color -1;
           terminals
            input 608 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 840 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 156.8 843.2 163.2 color -1 fill 0;
            ellipse 835.7 155.7 844.3 164.3 color -1;
           terminals
            input 840 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 840 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 460.8 843.2 467.2 color -1 fill 0;
            ellipse 835.7 459.7 844.3 468.3 color -1;
           terminals
            input 840 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 696 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 816 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 816 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 696 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 696 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 816 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 816 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 816 8
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 8 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 816 648
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 648 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 696 216
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 167.76];
          end;
          icon bg left
           figures
            rectangle 680 200 712 232 color 0 fill 15132390;
            text 'ò' 693.3 216 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_A1 888 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 167.76];
          end;
          icon bg bottom
           figures
            rectangle 872 24 904 56 color 0 fill 15132390;
            text 'ò' 885.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 696 400
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 19.5];
          end;
          icon bg left
           figures
            rectangle 680 384 712 416 color 0 fill 15132390;
            text 'ò' 693.3 400 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 888 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 19.5];
          end;
          icon bg bottom
           figures
            rectangle 872 544 904 576 color 0 fill 15132390;
            text 'ò' 885.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 400 352;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 840 40;
         Splitter9\output -> X_B2\input 840 560;
         vA_0\outp -> X_A\input;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> X_B1\input;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_20 216 928
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 912 256 944 color 0 fill 16777152;
         text 'name' 216 928 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 192 336;
         plug p1 440 664;
         plug output1 488 664;
         plug output 488 24;
         plug P 184 296;
         plug p 440 32;
         OneJunction 688 96
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 96 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 592
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 592 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 96
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 96 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 592
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 592 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 24
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 24 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 664
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 664 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 177.08];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 20.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         output1 <- Splitter4\output;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Element_21 216 1168
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         signal out output1 [3,1];
         power out p1 [3,1];
         power out P1 [3,1];
       end;
       implementation bg
        submodels
         Body3_213 400 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 376 296 424 328 color 0 fill 15132390;
            text 'Cardan' 400 312 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 224
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 224 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 440 408
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 440 408 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 440 224
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 440 224 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 480 360
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 464 344.1 496 375.9 color 0 fill 15132390;
            text 'R01' 480 360 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 375 259.5
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 375 259.5 color 0 21 bold;
           terminals
            P 392 255.6 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 392 376
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 392 376 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 272
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 272 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 400
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 400 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug P1 208 344;
         plug p1 440 632;
         plug output1 568 632;
         plug output 568 24;
         plug P 216 280;
         plug p 440 32;
         OneJunction 816 88
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 88 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 816 584
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 584 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 520 432
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 595 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 573 130 617.1 190 color 0 fill 14013909;
            text 'R01' 595.1 160 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 600 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 578 434 622 494 color 0 fill 14013909;
            text 'R01' 600 464 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 627.1 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 605.1 282 649.1 342 color 0 fill 14013909;
            text 'R01' 627.1 312 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 323.1 144.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 307.1 128.2 339.1 160 color 0 fill 15132390;
            line 318.8 133 318.8 155 color 16711680 width 2;
            line 329.9 130.3 329.9 156 color 0;
            line 313.9 132.6 332.1 132.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 323.1 480
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
            line 318.8 468.9 318.8 490.9 color 16711680 width 2;
            line 329.9 466.2 329.9 491.9 color 0;
            line 313.9 468.5 332.1 468.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 744 88
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 88 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 744 584
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 744 584 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 360
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 356.8 939.2 363.2 color -1 fill 0;
            ellipse 931.7 355.7 940.3 364.3 color -1;
           terminals
            input 936 360 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter11 352 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
            ellipse 347.7 307.7 356.3 316.3 color -1;
           terminals
            input 352 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 568 312
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 564.8 308.8 571.2 315.2 color -1 fill 0;
            ellipse 563.7 307.7 572.3 316.3 color -1;
           terminals
            input 568 312 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 568 224
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 564.8 220.8 571.2 227.2 color -1 fill 0;
            ellipse 563.7 219.7 572.3 228.3 color -1;
           terminals
            input 568 224 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 568 392
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 564.8 388.8 571.2 395.2 color -1 fill 0;
            ellipse 563.7 387.7 572.3 396.3 color -1;
           terminals
            input 568 392 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 840 160
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 156.8 843.2 163.2 color -1 fill 0;
            ellipse 835.7 155.7 844.3 164.3 color -1;
           terminals
            input 840 160 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 840 464
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 836.8 460.8 843.2 467.2 color -1 fill 0;
            ellipse 835.7 459.7 844.3 468.3 color -1;
           terminals
            input 840 464 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 656 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 656 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 440 160
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 440 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vA_2 816 160
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 816 160 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_1 440 464
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 440 464 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 656 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg right
           figures
            text '1' 656 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vB_3 816 464
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 816 464 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 312
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 312 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 440 264
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 440 264 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 816 16
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 16 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 816 656
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 816 656 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 323 224.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 200.6 355 247.6 color 0 fill 12895428;
            text 'w X rA/G' 323 224.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 323 408
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
            text 'w X rB/G' 323.1 408.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 323.1 312.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 323.1 312.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 656 216
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 186.4];
          end;
          icon bg left
           figures
            rectangle 640 200 672 232 color 0 fill 15132390;
            text 'ò' 653.3 216 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_A1 888 40
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 186.4];
          end;
          icon bg bottom
           figures
            rectangle 872 24 904 56 color 0 fill 15132390;
            text 'ò' 885.3 40 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 656 400
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 21.5];
          end;
          icon bg left
           figures
            rectangle 640 384 672 416 color 0 fill 15132390;
            text 'ò' 653.3 400 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B2 888 560
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 21.0];
          end;
          icon bg bottom
           figures
            rectangle 872 544 904 576 color 0 fill 15132390;
            text 'ò' 885.3 560 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 344
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 328 872 360 color 0 fill 15132390;
            text '∫' 853.3 344 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_2\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_3\P;
         OneJunction1\p => WBContact1\p;
         p => vA_1\p;
         P => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 360;
         Splitter11\output -> Body3_213\w;
         Splitter11\output -> Gain\input 408 360;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> output1;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter7\output -> X_A1\input 840 40;
         Splitter9\output -> X_B2\input 840 560;
         vA_0\outp -> X_A\input;
         vA_0\P => vA_2\P;
         vA_1\p => R01_vA1\PowIn;
         vA_2\outp -> Splitter7\input;
         vB_1\p => p1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> X_B1\input;
         vB_2\P => vB_3\P;
         vB_3\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 552 264;
         w_1\outp -> Splitter11\input;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => P1;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      Interface_16 216 104
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 88 256 120 color 0 fill 55295;
         text 'name' 216 104 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 92.4 48;
         plug V_B10 343.1 48;
         plug input 215 37.5;
         plug input1 182 199;
         plug p 312 128;
         plug p1 120 112;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         X_B2 384 88
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 4.282075];
          end;
          icon bg left
           figures
            rectangle 368 72 400 104 color 0 fill 15132390;
            text 'ò' 381.3 88 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\flow -> X_B2\input;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_17 216 344
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 328 256 360 color 0 fill 55295;
         text 'name' 216 344 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 320;
         plug V_B10 304 312;
         plug input 213.4 199;
         plug input1 214.9 439;
         plug p 304 352;
         plug p1 128 368;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_18 216 568
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 552 256 584 color 0 fill 55295;
         text 'name' 216 568 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 560;
         plug V_B10 304 552;
         plug input 215.2 439;
         plug input1 215.4 671;
         plug p 312 600;
         plug p1 136 600;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_19 216 816
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 800 256 832 color 0 fill 55295;
         text 'name' 216 816 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 792;
         plug V_B10 304 784;
         plug input 215.5 671;
         plug input1 215.6 911;
         plug p 304 824;
         plug p1 128 840;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Interface_20 220 1048
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 176 1032 264 1064 color 0 fill 55295;
         text 'name' 224 1048 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 136 1032;
         plug V_B10 304 1024;
         plug input 215.7 911;
         plug input1 215.7 1151;
         plug p 304 1072;
         plug p1 136 1064;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction1\p;
         K_Trans\p => OneJunction2\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction1\p => p;
         OneJunction19\p => p1;
         OneJunction2\p => K\p;
         OneJunction3\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction3\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      plug v_B10_OUT 336 1288;
      plug Cardan_OUT 216 1288;
      plug om_B10_OUT 88 1288;
      plug Cardan_IN 216 32.5;
      plug V_B10_IN 352 40;
      plug Om_B10_IN 88 40;
     end;
     connections
      Cardan_IN -> Interface_16\input;
      Element_17\output -> Interface_17\input;
      Element_17\output1 -> Interface_16\input1;
      Element_17\P1 => Interface_17\Om_B10 136 240 136 320;
      Element_17\p1 => Interface_17\V_B10 304 240 304 312;
      Element_18\output -> Interface_18\input;
      Element_18\output1 -> Interface_17\input1;
      Element_18\P1 => Interface_18\Om_B10 136 480 136 560;
      Element_18\p1 => Interface_18\V_B10 304 480 304 552;
      Element_19\output -> Interface_19\input;
      Element_19\output1 -> Interface_18\input1;
      Element_19\P1 => Interface_19\Om_B10 136 712 136 792;
      Element_19\p1 => Interface_19\V_B10 304 712 304 784;
      Element_20\output -> Interface_20\input;
      Element_20\output1 -> Interface_19\input1;
      Element_20\P1 => Interface_20\Om_B10 136 952 136 1032;
      Element_20\p1 => Interface_20\V_B10 304 952 304 1024;
      Element_21\output -> Cardan_OUT;
      Element_21\output1 -> Interface_20\input1;
      Element_21\P1 => om_B10_OUT 104 1208;
      Element_21\p1 => v_B10_OUT 312 1208;
      Interface_16\p => Element_17\p 312 128 312 192;
      Interface_16\p1 => Element_17\P 120 112 120 176;
      Interface_17\p => Element_18\p 304 352 304 424;
      Interface_17\p1 => Element_18\P 128 368 128 440;
      Interface_18\p => Element_19\p 312 600 312 664;
      Interface_18\p1 => Element_19\P 136 600 136 664;
      Interface_19\p => Element_20\p 304 824 304 896;
      Interface_19\p1 => Element_20\P 128 840 128 912;
      Interface_20\p => Element_21\p 304 1072 304 1160;
      Interface_20\p1 => Element_21\P 136 1064 136 1168;
      Om_B10_IN => Interface_16\Om_B10;
      V_B10_IN => Interface_16\V_B10;
     end;
    implementation_end;
   First_Element 248 144
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
    type Submodel
     ports
      signal out output [3,1];
      power out P [3,1];
      power out p [3,1];
      power out P1 [3,1];
    end;
    icon bg bottom
     figures
      rectangle 208 128 288 160 color 0 fill 16443110;
      text 'name' 248 144 color 0 16;
    end;
    implementation bg
     submodels
      Body3_213 400 312
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Cardan1
        ports
         signal in w [3,1];
         signal out RotAng [3,1];
       end;
       icon bg
        figures
         rectangle 376 296 424 328 color 0 fill 15132390;
         text 'Cardan' 400 312 color 0 16;
       end;
       implementation bg
        submodels
         intgrl 200 130.7
          type intgrl1
           ports
            signal in inp [3,1];
            signal out outp [3,1];
          end;
          icon bg
           figures
            rectangle 184 114.7 216 146.7 color 0 fill 15132390;
            spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
          end;
          implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
         plug w 32 130;
         plug RotAng 264 32;
         RotAngDot 112 128
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillB1
           ports
            signal in Omega [3,1];
            signal in RotAng [3,1];
            signal out RotAngDot [3,1];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
         Splitter1 200 32
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
            ellipse 195.7 27.7 204.3 36.3 color -1;
           terminals
            input 200 32 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
        end;
        connections
         intgrl\outp -> Splitter1\input;
         RotAngDot\RotAngDot -> intgrl\inp;
         Splitter1\output -> RotAng;
         Splitter1\output -> RotAngDot\RotAng;
         w -> RotAngDot\Omega;
        end;
       implementation_end;
      Fz1 792 224
       type se1
        ports
         power out p [3,1];
         signal in eccentricity [3,1];
        restrictions
         causality fixed out p;
       end;
       icon bg
        figures
         text 'Se' 792 224 color 0 18 bold;
       end;
       implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
      F_A1 464 408
       knot ZeroJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_in P;
       end;
       icon bg
        figures
         text '0' 464 408 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
      F_A10 464 224
       knot ZeroJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_in P;
       end;
       icon bg right
        figures
         text '0' 464 224 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
      Gain 520 352
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
       type Gain
        ports
         signal in input [3,1];
         signal out output [3,1];
         signal in R01 [3,3];
       end;
       icon bg top
        figures
         rectangle 504 336.1 536 367.9 color 0 fill 15132390;
         text 'R01' 520 352 color 16711680 16 bold;
       end;
       implementation eq

equations
	output = R01 * input;
    implementation_end;
      GY 104 312
       description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\GY.emx</LibraryPath>
  <TimeStamp>2011-11-29 15:53:45</TimeStamp>
</Description>
</Information>';
       type GY
        ports
         power in p1 [3,1];
         power out p2 [3,1];
        restrictions
         causality constraint equal p1 p2;
       end;
       icon bg bottom
        figures
         text 'GY' 104 312 color 0 18 bold;
       end;
       implementation eq
parameters
	real r=1;

equations

	p1.e = r * p2.f;
	p2.e = r * p1.f;
implementation_end;
      Gyro 375 259.5
       type EJS1
        ports
         power in P [3,1];
        restrictions
         causality fixed out P;
       end;
       icon bg
        figures
         text 'MGY' 375 259.5 color 0 21 bold;
        terminals
         P 392 255.6 fixed;
       end;
       implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
      J 392 376
       type I
        ports
         power in p [3,1];
         signal out outp [3,1];
        restrictions
         causality preferred in p;
       end;
       icon bg bottom
        figures
         text 'I' 392 376 color 0 18 bold;
       end;
       implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
      LateralDampingModel 976 272
       description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type R
        ports
         power in p [3,1];
         signal in eccentricity [3,1] {m} ;
       end;
       icon bg top
        figures
         text 'R' 976 272 color 0 18 bold;
       end;
       implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
      Mass 760 400
       type i1
        ports
         power in p [3,1];
         signal out outp [3,1];
        restrictions
         causality preferred in p;
       end;
       icon bg bottom
        figures
         text 'I' 760 400 color 0 18 bold;
       end;
       implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
      MSe1 104 440
       description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\MSe.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:12:33</TimeStamp>
</Description>
</Information>';
       type MSe
        ports
         power out p [3,1];
         signal in effort [3,1];
        restrictions
         causality fixed out p;
       end;
       icon bg bottom
        figures
         text 'MSe' 104 440 color 0 18 bold;
       end;
       implementation eq
variables
	real flow [3,1];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
      plug P1 216 216;
      plug p 464 544;
      plug P 704 32;
      plug output 616 544;
      OneJunction 880 72
       description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
       knot OneJunction
        ports
         power knot duplicatable none p [3,1];
         signal knot out flow [3,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 880 72 color 0 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction1 880 552
       description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
       knot OneJunction
        ports
         power knot duplicatable none p [3,1];
         signal knot out flow [3,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 880 552 color 0 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      PIDCntroller 176 440
       description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Control\PID Control\Continuous\PID.emx</LibraryPath><TimeStamp>2008-1-17 10:49:30</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type PID
        ports
         signal in error [3,1];
         signal out output [3,1];
       end;
       icon bg bottom
        figures
         rectangle 160 424 192 456 color 0 fill 15132390;
         text 'PID' 176 439.5 color 16711680 18 bold;
       end;
       implementation eq
parameters
	real kp = 5{};			// Proportional gain
	real tauD = 0.1 {s};		// Derivative time constant: tauD > 0
	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1
	real tauI = 0.1 {s};		// Integral time constant: tauI > 0
variables
	real pdout[3,1], pdrate[3,1], pdstate[3,1];
	real pirate[3,1], pistate[3,1];  
equations
	pdrate = (kp * error - pdout) / (beta * tauD);
	pdstate = int (pdrate);
	pdout = pdstate + (kp * error / beta);
	pirate = pdout / tauI;
	pistate = int (pirate);

	output = pistate + pdout;
      implementation_end;
      PlusMinus 232 440
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>
  <TimeStamp>2007-9-27 10:15:13</TimeStamp>
</Description>';
       knot PlusMinus
        ports
         signal knot duplicatable in minus [3,1];
         signal knot out output [3,1];
         signal knot in plus [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 224 432 240 448 color 0 fill 16777215;
       end;
       implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
      R01 560 424
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type FillA011
        ports
         signal in CAng [3,1];
         signal out A [3,3];
       end;
       implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
      R01_vA1 643 160
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type MTA011
        ports
         power none PowOut [3,1];
         power none PowIn [3,1];
         signal in Cardan [3,1];
       end;
       icon bg top
        figures
         rectangle 621 130 665.1 190 color 0 fill 14013909;
         text 'R01' 643.1 160 color 0;
       end;
       implementation bg
        submodels
         MTF_R01 176 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'MTF_act-3'
           ports
            power in p1 [3,1];
            power out p2 [3,1];
            signal in r [3,3];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 176 168 color 0 'Courier New' 18 bold;
           terminals
            p1 152 168 fixed;
            p2 200 168 fixed;
          end;
          implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
         plug PowOut 301.4 168;
         plug PowIn 45.3 168;
         plug Cardan 176 32;
         R01 176 96
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
        end;
        connections
         Cardan -> R01\CAng;
         MTF_R01\p2 => PowOut;
         PowIn => MTF_R01\p1;
         R01\A -> MTF_R01\r;
        end;
       implementation_end;
      R01_vB2 648 464
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type MTA011
        ports
         power none PowOut [3,1];
         power none PowIn [3,1];
         signal in Cardan [3,1];
       end;
       icon bg bottom
        figures
         rectangle 626 434 670 494 color 0 fill 14013909;
         text 'R01' 648 464 color 0;
       end;
       implementation bg
        submodels
         MTF_R01 176 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'MTF_act-3'
           ports
            power in p1 [3,1];
            power out p2 [3,1];
            signal in r [3,3];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 176 168 color 0 'Courier New' 18 bold;
           terminals
            p1 152 168 fixed;
            p2 200 168 fixed;
          end;
          implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
         plug PowOut 301.4 168;
         plug PowIn 45.3 168;
         plug Cardan 176 32;
         R01 176 96
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
        end;
        connections
         Cardan -> R01\CAng;
         MTF_R01\p2 => PowOut;
         PowIn => MTF_R01\p1;
         R01\A -> MTF_R01\r;
        end;
       implementation_end;
      R01_vG1 675.1 312
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type MTA011
        ports
         power none PowOut [3,1];
         power none PowIn [3,1];
         signal in Cardan [3,1];
       end;
       icon bg bottom
        figures
         rectangle 653.1 282 697.1 342 color 0 fill 14013909;
         text 'R01' 675.1 312 color 0;
       end;
       implementation bg
        submodels
         MTF_R01 176 168
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'MTF_act-3'
           ports
            power in p1 [3,1];
            power out p2 [3,1];
            signal in r [3,3];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 176 168 color 0 'Courier New' 18 bold;
           terminals
            p1 152 168 fixed;
            p2 200 168 fixed;
          end;
          implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
         plug PowOut 301.4 168;
         plug PowIn 45.3 168;
         plug Cardan 176 32;
         R01 176 96
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
        end;
        connections
         Cardan -> R01\CAng;
         MTF_R01\p2 => PowOut;
         PowIn => MTF_R01\p1;
         R01\A -> MTF_R01\r;
        end;
       implementation_end;
      rA_G_1 320 96
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type con1
        ports
         signal out output [3,1];
       end;
       icon bg left
        figures
         rectangle 304 80.1 336 111.9 color 0 fill 15132390;
         line 315.7 84.9 315.7 106.9 color 16711680 width 2;
         line 326.8 82.2 326.8 107.9 color 0;
         line 310.8 84.5 329 84.5 color 0;
       end;
       implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
      rB_G_1 323.1 480
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type con1
        ports
         signal out output [3,1];
       end;
       icon bg bottom
        figures
         rectangle 307.1 464.1 339.1 495.9 color 0 fill 15132390;
         line 318.8 468.9 318.8 490.9 color 16711680 width 2;
         line 329.9 466.2 329.9 491.9 color 0;
         line 313.9 468.5 332.1 468.5 color 0;
       end;
       implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
      RWB 808 72
       description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type R
        ports
         power in p [3,1];
       end;
       icon bg bottom
        figures
         text 'R' 808 72 color 0 18 bold;
       end;
       implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
      RWB1 808 552
       description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type R
        ports
         power in p [3,1];
       end;
       icon bg bottom
        figures
         text 'R' 808 552 color 0 18 bold;
       end;
       implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
      Splitter10 928 360
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 924.8 356.8 931.2 363.2 color -1 fill 0;
         ellipse 923.7 355.7 932.3 364.3 color -1;
        terminals
         input 928 360 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter2 616 312
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 612.8 308.8 619.2 315.2 color -1 fill 0;
         ellipse 611.7 307.7 620.3 316.3 color -1;
        terminals
         input 616 312 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter3 616 224
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 612.8 220.8 619.2 227.2 color -1 fill 0;
         ellipse 611.7 219.7 620.3 228.3 color -1;
        terminals
         input 616 224 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter4 616 392
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 612.8 388.8 619.2 395.2 color -1 fill 0;
         ellipse 611.7 387.7 620.3 396.3 color -1;
        terminals
         input 616 392 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter7 904 160
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 900.8 156.8 907.2 163.2 color -1 fill 0;
         ellipse 899.7 155.7 908.3 164.3 color -1;
        terminals
         input 904 160 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter8 352 312
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 348.8 308.8 355.2 315.2 color -1 fill 0;
         ellipse 347.7 307.7 356.3 316.3 color -1;
        terminals
         input 352 312 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter9 904 464
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [3,1];
         signal knot in input [3,1];
       end;
       icon bg ellipse
        figures
         ellipse 900.8 460.8 907.2 467.2 color -1 fill 0;
         ellipse 899.7 459.7 908.3 468.3 color -1;
        terminals
         input 904 464 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      vA_0 704 160
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg right
        figures
         text '1' 704 160 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      vA_1 464 160
       description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [3,1];
         signal knot out flow [3,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg top
        figures
         text '1' 464 160 color 0 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      vA_2 880 160
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg top
        figures
         text '1' 880 160 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      vB_1 464 464
       description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       knot OneJunction
        ports
         power knot duplicatable none p [3,1];
         signal knot out flow [3,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg bottom
        figures
         text '1' 464 464 color 0 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      vB_2 704 464
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg right
        figures
         text '1' 704 464 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      vB_3 880 464
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg bottom
        figures
         text '1' 880 464 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      vG_0 760 312
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg bottom
        figures
         text '1' 760 312 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      vG_1 464 264
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg left
        figures
         text '1' 464 264 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      WBContact 880 24
       description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type C
        ports
         power in p [3,1];
         signal out state [3,1];
        restrictions
         causality preferred out p;
       end;
       icon bg bottom
        figures
         text 'C' 880 24 color 0 18 bold;
       end;
       implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
      WBContact1 880 624
       description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
       type C
        ports
         power in p [3,1];
         signal out state [3,1];
        restrictions
         causality preferred out p;
       end;
       icon bg bottom
        figures
         text 'C' 880 624 color 0 18 bold;
       end;
       implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
      wxr 323 224.1
       description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
       type wxr
        ports
         power out PowOut [3,1];
         power in PowIn [3,1];
         signal in X [3,1];
       end;
       icon bg
        figures
         rectangle 291 200.6 355 247.6 color 0 fill 12895428;
         text 'w X rA/G' 323 224.2 color 0 16;
       end;
       implementation bg
        submodels
         CrossPr 164 80
          type FillX1
           ports
            signal in X [3,1];
            signal out Fmt [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
         plug PowOut 288 104;
         plug PowIn 40 104;
         plug X 160 24;
         PowerIn 80 152
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg
           figures
            text '1' 80 152 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         PowerOut 240 152
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg
           figures
            text '1' 240 152 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         wxr 160 152
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'MTF_act-3'
           ports
            power in p1 [3,1];
            power out p2 [3,1];
            signal in r [3,3];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 160 152 color 0 20 bold;
           terminals
            p1 136 152 fixed;
            p2 184 152 fixed;
          end;
          implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
        end;
        connections
         CrossPr\Fmt -> wxr\r;
         PowerIn\P => wxr\p1;
         PowerOut\P => PowOut;
         PowIn => PowerIn\P;
         wxr\p2 => PowerOut\P;
         X -> CrossPr\X;
        end;
       implementation_end;
      wxr1 323 408
       description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
       type wxr
        ports
         power out PowOut [3,1];
         power in PowIn [3,1];
         signal in X [3,1];
       end;
       icon bg
        figures
         rectangle 291 384.6 355.1 431.5 color 0 fill 12895428;
         text 'w X rB/G' 323.1 408.1 color 0 16;
       end;
       implementation bg
        submodels
         CrossPr 164 80
          type FillX1
           ports
            signal in X [3,1];
            signal out Fmt [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
         plug PowOut 288 104;
         plug PowIn 40 104;
         plug X 162.7 24;
         PowerIn 80 152
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg
           figures
            text '1' 80 152 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         PowerOut 240 152
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg
           figures
            text '1' 240 152 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         wxr 160 152
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type 'MTF_act-3'
           ports
            power in p1 [3,1];
            power out p2 [3,1];
            signal in r [3,3];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 160 152 color 0 20 bold;
           terminals
            p1 136 152 fixed;
            p2 184 152 fixed;
          end;
          implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
        end;
        connections
         CrossPr\Fmt -> wxr\r;
         PowerIn\P => wxr\p1;
         PowerOut\P => PowOut;
         PowIn => PowerIn\P;
         wxr\p2 => PowerOut\P;
         X -> CrossPr\X;
        end;
       implementation_end;
      w_1 323.1 312.1
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none P [3,1];
         signal knot out outp [3,1];
        restrictions
         causality constraint one_out P;
       end;
       icon bg left
        figures
         text '1' 323.1 312.1 color 0 18 bold;
       end;
       implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
      W_setValue 232 512
       description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\Constant.emx</LibraryPath><TimeStamp>2007-10-19 14:48:44</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Constant
        ports
         signal out output [3,1];
       end;
       icon bg bottom
        figures
         rectangle 216.1 496 247.9 528 color 0 fill 15132390;
         line 220.9 507.6 242.9 507.6 color 16711680 width 2;
         line 218.2 518.7 243.9 518.7 color 0;
         line 220.5 502.7 220.5 521 color 0;
       end;
       implementation eq
parameters
	real C[3,1] = [0,0,10];		// set to 100 rpm
equations
	
	output = C;
     implementation_end;
      X_A1 952 40
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Integrate
        ports
         signal in input [3,1];
         signal out output [3,1];
        parameters
         real initial[3,1] = [0.0; 0.0; 0.0];
       end;
       icon bg bottom
        figures
         rectangle 936 24 968 56 color 0 fill 15132390;
         text 'ò' 949.3 40 color 16711680 'SymbolProp BT' 21 symbol;
       end;
       implementation eq
equations
	output = int (input, initial);
     implementation_end;
      X_B2 952 560
       description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Integrate
        ports
         signal in input [3,1];
         signal out output [3,1];
        parameters
         real initial[3,1] = [0.0; 0.0; 8.75];
       end;
       icon bg bottom
        figures
         rectangle 936 544 968 576 color 0 fill 15132390;
         text 'ò' 949.3 560 color 16711680 'SymbolProp BT' 21 symbol;
       end;
       implementation eq
equations
	output = int (input, initial);
     implementation_end;
      X_G 848 344
       description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Integrate
        ports
         signal in input [3,1];
         signal out output [3,1];
        parameters
         real initial[3,1] = [0.0; 0.0; 0.0];
       end;
       icon bg bottom
        figures
         rectangle 832 328 864 360 color 0 fill 15132390;
         text '∫' 845.3 344 color 16711680 'SymbolProp BT' 21;
       end;
       implementation eq
equations
	output = int (input, initial);
     implementation_end;
     end;
     connections
      Body3_213\RotAng -> Splitter2\input;
      F_A1\P => vB_1\p;
      F_A10\P => vA_1\p;
      Fz1\p => vG_0\P;
      GY\p2 => w_1\P;
      LateralDampingModel\p <= vG_0\P;
      MSe1\p => GY\p1;
      OneJunction\p => RWB\p;
      OneJunction\p => vA_2\P;
      OneJunction\p => WBContact\p;
      OneJunction1\p => RWB1\p;
      OneJunction1\p => vB_3\P;
      OneJunction1\p => WBContact1\p;
      PIDCntroller\output -> MSe1\effort;
      PlusMinus\output -> PIDCntroller\error;
      R01_vA1\PowOut => vA_0\P;
      R01_vB2\PowOut => vB_2\P;
      R01_vG1\PowOut => vG_0\P;
      R01\A -> Gain\R01;
      rA_G_1\output -> wxr\X;
      rB_G_1\output -> wxr1\X;
      Splitter10\output -> Fz1\eccentricity;
      Splitter10\output -> LateralDampingModel\eccentricity 928 360;
      Splitter2\output -> R01_vG1\Cardan;
      Splitter2\output -> R01\CAng;
      Splitter2\output -> Splitter3\input;
      Splitter2\output -> Splitter4\input;
      Splitter3\output -> R01_vA1\Cardan;
      Splitter4\output -> output;
      Splitter4\output -> R01_vB2\Cardan;
      Splitter7\output -> X_A1\input 904 40;
      Splitter8\output -> Body3_213\w;
      Splitter8\output -> Gain\input 400 352;
      Splitter8\output -> PlusMinus\plus 232 360;
      Splitter9\output -> X_B2\input 904 560;
      vA_0\P => P;
      vA_0\P => vA_2\P;
      vA_1\p => R01_vA1\PowIn;
      vA_2\outp -> Splitter7\input;
      vB_1\p => p;
      vB_1\p => R01_vB2\PowIn;
      vB_2\P => vB_3\P;
      vB_3\outp -> Splitter9\input;
      vG_0\outp -> X_G\input;
      vG_0\P => Mass\p;
      vG_1\P => F_A1\P;
      vG_1\P => F_A10\P;
      vG_1\P => R01_vG1\PowIn 576 264;
      w_1\outp -> Splitter8\input;
      w_1\P => Gyro\P;
      w_1\P => J\p;
      w_1\P => P1;
      w_1\P => wxr\PowIn;
      w_1\P => wxr1\PowIn;
      W_setValue\output -> PlusMinus\minus;
      wxr\PowOut => F_A10\P;
      wxr1\PowOut => F_A1\P;
      X_G\output -> Splitter10\input;
     end;
    implementation_end;
   Gain 520 80
    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
    type Gain
     ports
      signal in input;
      signal out output;
    end;
    icon bg bottom
     figures
      rectangle 504.1 64 535.9 96 color 0 fill 15132390;
      text 'K' 520 80 color 16711680 16 bold;
    end;
    implementation eq
variables
	real K;		// gain
	
equations
		
if input<0 then
	K = -1;
else
	K = 1;
end;


	output = K * input;
    implementation_end;
   Gain1 520 136
    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
    type Gain
     ports
      signal in input;
      signal out output;
    end;
    icon bg bottom
     figures
      rectangle 504.1 120 535.9 152 color 0 fill 15132390;
      text 'K' 520 136 color 16711680 16 bold;
    end;
    implementation eq
variables
	real K;		// gain
	
equations
		
if input<0 then
	K = -1;
else
	K = 1;
end;


	output = K * input;
    implementation_end;
   Gain2 520 200
    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
    type Gain
     ports
      signal in input;
      signal out output;
    end;
    icon bg bottom
     figures
      rectangle 504.1 184 535.9 216 color 0 fill 15132390;
      text 'K' 520 200 color 16711680 16 bold;
    end;
    implementation eq
variables
	real K;		// gain
	
equations
		
if input<0 then
	K = -1;
else
	K = 1;
end;


	output = K * input;
    implementation_end;
   Gain3 520 256
    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
    type Gain
     ports
      signal in input;
      signal out output;
    end;
    icon bg bottom
     figures
      rectangle 504.1 240 535.9 272 color 0 fill 15132390;
      text 'K' 520 256 color 16711680 16 bold;
    end;
    implementation eq
variables
	real K;		// gain
	
equations
		
if input<0 then
	K = -1;
else
	K = 1;
end;


	output = K * input;
    implementation_end;
   K 608 256
			specifications active 'frequency_limited_FOH'
				specification 'frequency_limited_FOH'
 description '<Information><Description><Version>4.1</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath><TimeStamp>2009-6-18 15:46:03</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 592 240 624 272 color 0 fill 15132390;
    text 'FOH' 613.7 267 color 0 8 bold;
    line 596.3 251.9 599.2 250.7 600 248 601.3 246.3 602.7 261.5 604.2 263.2 605.5 249.7 606.8 248.8 608.7 259.7 611.5 261.8 613 247.5 614 245.5 615.2 249 615.5 253.2 617.5 254.5 619.9 254.6 color 16711680;
    line 622.1 256 593.3 256 color 0;
    line 596.5 246.4 596.5 265.6 color 0;
   end;
 end;
 implementation eq
parameters
	real amplitude = 2;			
	real seed = 0;					
	real frequency = 1.5 {Hz};		// hold frequency on output
variables
	real hidden t_hit {s}, h {s}, dt {s};
	real hidden buffer, buffer_hit, slope;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
	buffer_hit = ran (amplitude, seed);
	slope = (buffer_hit - buffer) / h;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = buffer_hit;
		buffer_hit = ran (amplitude,seed);
		slope = (buffer_hit - buffer) / h;
	end;
	dt = t_hit - time;
	output = if (dt == 0) then 
		buffer 
	else 
		buffer + slope * (h - dt) end;
implementation_end;
specification_end;
				specification 'frequency_limited_ZOH'
description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 232 192 264 224 fill 15132390;
    line 236.5 198.4 236.5 217.6;
    line 262.1 208 233.3 208;
    line 236.3 203.9 239.8 204 239.8 198.2 242.7 198.3 242.7 215.3 245.3 215.5 245.5 201.7 248.7 201.8 248.7 211.7 253 211.8 253 199.5 255.2 199.5 255.3 196 257.7 195.8 257.5 206.5 259.9 206.6 color 16711680;
    text 'ZOH' 253.7 219 8 bold;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1.0;			
	real seed = 0.0;					
	real frequency = 100.0 {Hz};		// ZOH frequency on output
variables
	real hidden t_hit {s}, h {s};
	real hidden buffer;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = ran (amplitude,seed);
	end;
	output = buffer;
implementation_end;
specification_end;
				specification 'unlimited'
description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
  <TimeStamp>2009-6-17 13:48:54</TimeStamp>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   rectangle 232 192 264 224 fill 15132390;
   line 236.5 198.4 236.5 217.6;
   line 262.1 208 233.3 208;
   line 236.3 203.9 238.1 198.4 240 206.6 241.8 197.9 243.7 217.8 245.3 211.2 246.4 205.3 248.7 200 250.9 220.3 252.3 216.7 253 203.2 254.6 206.9 255.5 197 257.1 200 258.9 196.5 259.9 206.6 color 16711680;
 end;
 implementation eq
parameters
	real amplitude = 1.0;
	real seed = 0.0;
equations
	output = ran (amplitude,seed);
      implementation_end;
specification_end;
			end;
   Last_Element 248 456
    description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
    type Submodel
     ports
      power in Om_B10 [3,1];
      power in V_B10 [3,1];
      signal in input [3,1];
      power out P_VB_1 [3,1];
    end;
    icon bg bottom
     figures
      rectangle 208 440 288 472 color 0 fill 16443110;
      text 'name' 248 456 color 0 16;
    end;
    implementation bg
     submodels
      Interface_31 152 112
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in Om_B10 [3,1];
         power in V_B10 [3,1];
         signal in input [3,1];
         signal in input1 [3,1];
         power out p [3,1];
         power out p1 [3,1];
       end;
       icon bg
        figures
         rectangle 112 96 192 128 color 0 fill 55295;
         text 'name' 152 112 color 0 16;
       end;
       implementation bg
        submodels
         K 232 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 232 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_SSA_p[3,3];

equations
    state = int(p.f);
    p.e = K_SSA_p *state;
implementation_end;
         Kt 176 312
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\C-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:12:8</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg top
           figures
            text 'C' 176 312 color 0 18 bold;
          end;
          implementation eq
variables
	real global K_BBT_p[3,3];
equations
    state = int(p.f);
    p.e = K_BBT_p *state;
implementation_end;
         Kt_Torque 88 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg left
           figures
            text '0' 88 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         K_Trans 320 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out effort [3,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg right
           figures
            text '0' 320 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         plug Om_B10 152 576;
         plug V_B10 344 568;
         plug input 245.9 487;
         plug input1 243.5 671.5;
         plug p 344 616;
         plug p1 152 616;
         Om_B0 72 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 72 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction 272 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction19 88 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 88 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction2 320 320
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 320 320 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction3 272 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 272 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction4 128 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 272 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction6 128 312
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 128 312 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01_Rot 128 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in Om_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 88.3 165.1 135.7 color 0 fill 11788799;
            text 'MTF' 128 111 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_B10 192 83;
            plug vel_inertial 192 523;
            plug Cardan 416 275;
            OneJunction1 192 179
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 179 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 192 427
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 192 427 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 192 275
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 192 275 color 0 'Courier New' 18 bold;
              terminals
               p1 192 251 fixed;
               p2 192 299 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 304 272
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real 	A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            Om_B10 => OneJunction1\p;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
           end;
          implementation_end;
         R01_Trans 272 112
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R01_Cardan
           ports
            power in V_B10 [3,1];
            power out vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 88.3 309.1 135.7 color 0 fill 11788799;
            text 'MTF' 272 112 color 0 16;
          end;
          implementation bg
           submodels
            plug V_B10 400 104;
            plug vel_inertial 400 560;
            plug Cardan 168 336;
            OneJunction1 400 216
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 216 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 400 456
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 400 456 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 400 336
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 400 336 color 0 'Courier New' 18 bold;
              terminals
               p1 400 312 fixed;
               p2 400 360 fixed;
             end;
             implementation eq


equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf01 280 336
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=A;
	implementation_end;
           end;
           connections
            Cardan -> Transf01\CAng;
            OneJunction1\p => Trans01\p1;
            OneJunction2\p => vel_inertial;
            Trans01\p2 => OneJunction2\p;
            Transf01\B -> Trans01\r;
            V_B10 => OneJunction1\p;
           end;
          implementation_end;
         R10_Rot 128 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out Om_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg left
           figures
            rectangle 90.9 184.3 165.1 231.7 color 0 fill 11788799;
            text 'MTF' 128 207 color 0 16;
          end;
          implementation bg
           submodels
            plug Om_A20 192 528;
            plug vel_inertial 192 80;
            plug Cardan 408 280;
            OneJunction1 195 408
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 408 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 195 192
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 195 192 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 195 280
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 195 280 color 0 'Courier New' 18 bold;
              terminals
               p1 195 256 fixed;
               p2 195 304 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 300 280
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
  
	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => Om_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         R10_Trans 272 208
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type trans_R10_Cardan
           ports
            power out V_A20 [3,1];
            power in vel_inertial [3,1];
            signal in Cardan [3,1];
          end;
          icon bg right
           figures
            rectangle 234.9 184.3 309.1 231.7 color 0 fill 11788799;
            text 'MTF' 272 208 color 0 16;
          end;
          implementation bg
           submodels
            plug V_A20 368.5 458.5;
            plug vel_inertial 368.5 10.5;
            plug Cardan 152.5 210.5;
            OneJunction1 368.5 338.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 338.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction2 368.5 122.5
             knot OneJunction
              ports
               power knot duplicatable none p [3,1];
               signal knot out flow [3,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 368.5 122.5 color 0 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Trans01 368.5 210.5
             type MTF_act
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 368.5 210.5 color 0 'Courier New' 18 bold;
              terminals
               p1 368.5 186.5 fixed;
               p2 368.5 234.5 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            Transf10 264 208
             type FillA011
              ports
               signal in CAng [3,1];
               signal out B [3,3];
             end;
             implementation eq
variables
	real A[3,3];
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;
equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
   	B=transpose(A);
	implementation_end;
           end;
           connections
            Cardan -> Transf10\CAng;
            OneJunction1\p => V_A20;
            OneJunction2\p => Trans01\p1;
            Trans01\p2 => OneJunction1\p;
            Transf10\B -> Trans01\r;
            vel_inertial => OneJunction2\p;
           end;
          implementation_end;
         Rt 176 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg top
           figures
            text 'R' 176 272 color 0 18 bold;
          end;
          implementation eq
variables
	real global R_BBT_p[3,3]; // Damping Bending
equations					
	p.e = R_BBT_p * p.f;
implementation_end;
         Splitter 200 112
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 108.8 203.2 115.2 color -1 fill 0;
            ellipse 195.7 107.7 204.3 116.3 color -1;
           terminals
            input 200 112 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter1 200 208
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 196.8 204.8 203.2 211.2 color -1 fill 0;
            ellipse 195.7 203.7 204.3 212.3 color -1;
           terminals
            input 200 208 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         V_B0 328 160
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2011-11-29 16:17:51</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg right
           figures
            text '1' 328 160 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         input -> Splitter\input;
         input1 -> Splitter1\input;
         K_Trans\p => OneJunction2\p;
         K_Trans\p => OneJunction3\p;
         Kt_Torque\p => OneJunction19\p;
         Kt_Torque\p => OneJunction6\p;
         Om_B0\p => R10_Rot\vel_inertial;
         Om_B10 => R01_Rot\Om_B10;
         OneJunction\p => K_Trans\p;
         OneJunction19\p => p1;
         OneJunction2\p => p;
         OneJunction3\p => K\p;
         OneJunction4\p => Kt_Torque\p;
         OneJunction6\p => Kt\p;
         OneJunction6\p => Rt\p;
         R01_Rot\vel_inertial => Om_B0\p;
         R01_Trans\vel_inertial => V_B0\p;
         R10_Rot\Om_A20 => OneJunction4\p;
         R10_Trans\V_A20 => OneJunction\p;
         Splitter\output -> R01_Rot\Cardan;
         Splitter\output -> R01_Trans\Cardan;
         Splitter1\output -> R10_Rot\Cardan;
         Splitter1\output -> R10_Trans\Cardan;
         V_B0\p => R10_Trans\vel_inertial;
         V_B10 => R01_Trans\V_B10;
        end;
       implementation_end;
      Last_Element 152 200
       description '<Information><Description><Version>4.7</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
       type Submodel
        ports
         power in p [3,1];
         power in P [3,1];
         signal out output [3,1];
         power out p_VB_1 [3,1];
       end;
       icon bg
        figures
         rectangle 112 184 192 216 color 0 fill 16777152;
         text 'name' 152 200 color 0 16;
       end;
       implementation bg
        submodels
         Body3_213 424 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Cardan1
           ports
            signal in w [3,1];
            signal out RotAng [3,1];
          end;
          icon bg
           figures
            rectangle 400 320 448 352 color 0 fill 15132390;
            text 'Cardan' 424 336 color 0 16;
          end;
          implementation bg
           submodels
            intgrl 200 130.7
             type intgrl1
              ports
               signal in inp [3,1];
               signal out outp [3,1];
             end;
             icon bg
              figures
               rectangle 184 114.7 216 146.7 color 0 fill 15132390;
               spline 195.9 141.5 200.2 136.5 200.7 125.5 204.5 121.3 color 16711680 fill 15132390 width 2;
             end;
             implementation eq
//    Integrator with transfer function:
// 
//                 1
//    G(s) = ---
//                 s
// 
//    The initial condition (IC) is:
//    outp(0) = state(0)
variables
	real	state[3];	//  integrated rate (state variable)
equations
	state = int(inp);
	outp = state;
implementation_end;
            plug w 32 130;
            plug RotAng 264 32;
            RotAngDot 112 128
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillB1
              ports
               signal in Omega [3,1];
               signal in RotAng [3,1];
               signal out RotAngDot [3,1];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
// 2013/04/18 Rideout Modified for Body3-213
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	costh;
	real	sinth;
	real	tanth;
	real	cospsi;
	real	sinpsi;
	real	B[3, 3];

equations
	costh = cos(RotAng[2]);
	sinth = sin(RotAng[2]);
	tanth = sinth / costh;
	cospsi = cos(RotAng[3]);
	sinpsi = sin(RotAng[3]);
	B[1, 1] = cospsi / costh;
	B[1, 2] = -sinpsi / costh;
	B[1, 3] = 0;
	B[2, 1] = sinpsi;
	B[2, 2] = cospsi;
	B[2, 3] = 0;
	B[3, 1] = -cospsi * tanth;
	B[3, 2] = sinpsi * tanth;
	B[3, 3] = 1;
	RotAngDot = B * Omega;implementation_end;
            Splitter1 200 32
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [3,1];
               signal knot in input [3,1];
             end;
             icon bg ellipse
              figures
               ellipse 196.8 28.8 203.2 35.2 color -1 fill 0;
               ellipse 195.7 27.7 204.3 36.3 color -1;
              terminals
               input 200 32 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
           end;
           connections
            intgrl\outp -> Splitter1\input;
            RotAngDot\RotAngDot -> intgrl\inp;
            Splitter1\output -> RotAng;
            Splitter1\output -> RotAngDot\RotAng;
            w -> RotAngDot\Omega;
           end;
          implementation_end;
         Fz1 800 248
          type se1
           ports
            power out p [3,1];
            signal in eccentricity [3,1];
           restrictions
            causality fixed out p;
          end;
          icon bg
           figures
            text 'Se' 800 248 color 0 18 bold;
          end;
          implementation eq
//    Bond graph Se element
parameters
	real global g;
	real global mass_p;
	real global V; //(Volume of an element)
	real global r_w;
	real global r_upset_o;
	
variables
	real global Rho;

	real global K;
	real global Tau;	
	real global v;
	real	S[3];	//  amplitude
	real U; //(Upthrust)
	real F_a;
	real d_min;
	
equations
	d_min = r_w - r_upset_o - eccentricity[1,1];
	
	U = V*Rho*g;
	F_a = 1/(0.458515 - 0.008247*d_min - 0.038522*Tau - 0.082539*K + 1.10167E-06*Rho - 0.091565*v + 0.002308*d_min * Tau - 0.000031 * d_min * K - 2.11882E-07 * d_min * Rho + 0.009765*d_min * v + 0.006870 * Tau * K + 1.01080E-06*Tau * Rho - 0.000888*Tau * v + 1.46571E-06*K * Rho - 0.035233*K * v - 0.000028*Rho * v + 0.000201*d_min^2 + 0.000949*Tau^2 + 0.020037*v^2 + 1.13421E-07*d_min * Tau * Rho + 0.000058*d_min * Tau * v - 0.000650*d_min * K * v - 1.62841E-06 * Tau * K * Rho + 0.001970*Tau * K * v + 0.000012*K * Rho * v - 0.000059*d_min^2 * Tau - 0.000219*d_min^2 * v)^2-6;

	S[1,1] = 0;
	S[2,1] = 0;
	S[3,1] = mass_p*g;
	
	p.e = S;
implementation_end;
         F_A1 464 432
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg
           figures
            text '0' 464 432 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         F_A10 464 248
          knot ZeroJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_in P;
          end;
          icon bg right
           figures
            text '0' 464 248 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.f)) = 0;
equal (collect (P.e));
outp = first (P.e);
implementation_end;
         Gain 504 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
          type Gain
           ports
            signal in input [3,1];
            signal out output [3,1];
            signal in R01 [3,3];
          end;
          icon bg top
           figures
            rectangle 488 360.1 520 391.9 color 0 fill 15132390;
            text 'R01' 504 376 color 16711680 16 bold;
          end;
          implementation eq

equations
	output = R01 * input;
    implementation_end;
         Gyro 351 283.9
          type EJS1
           ports
            power in P [3,1];
           restrictions
            causality fixed out P;
          end;
          icon bg
           figures
            text 'MGY' 351 283.9 color 0 21 bold;
           terminals
            P 368 280 fixed;
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
	
variables
	real global	I_p[3, 3];
	real	W[3, 3];
	
equations // eqn (23)
	W[1, 1] = 0;
	W[1, 2] = -P.f[3];
	W[1, 3] = P.f[2];
	W[2, 1] = P.f[3];
	W[2, 2] = 0;
	W[2, 3] = -P.f[1];
	W[3, 1] = -P.f[2];
	W[3, 2] = P.f[1];
	W[3, 3] = 0;
	
	P.e = W * I_p * P.f;
implementation_end;
         J 368 408
          type I
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 368 408 color 0 18 bold;
          end;
          implementation eq

variables
	real global	I_p[3,3];	//  inductance
	real state[3];

equations
    state = int(p.e);
    p.f = inverse(I_p) * state;
     implementation_end;
         LateralDampingModel 984 296
          description '<Information><Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath><TimeStamp>2007-9-25 12:11:54</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
            signal in eccentricity [3,1] {m} ;
          end;
          icon bg top
           figures
            text 'R' 984 296 color 0 18 bold;
          end;
          implementation eq
parameters

	real global r_w;
	real global r_upset_o;

variables
	
	real global Tau;
	real global K;
	real global Rho;
	real global v;
	real global C_c[3,3];
	real Zeta_x[1,1];
	real Zeta_y[1,1];
	real R_SSA_p[3,3]; // Damping Shear, Shear, Axial
	real d_min_x [1,1];// Minimum distance between wellbore and upset region of the drill pipe
	real d_min_y [1,1];

	
equations					

d_min_x[1,1] = r_w - r_upset_o - eccentricity[1,1];
d_min_y[1,1] = r_w - r_upset_o - eccentricity[2,1];
Zeta_x [1,1]	= 12.54627	- 0.693954*d_min_x - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_x * Tau + 0.184160*d_min_x * K + 0.000276*d_min_x * Rho	+ 0.157667*d_min_x * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_x^2	+0.109795*Tau^2 - 0.007902*d_min_x * Tau * K + 0.014765*d_min_x * Tau * v - 0.000118*d_min_x * K * Rho - 0.083163*d_min_x * K * v - 0.000127*d_min_x * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_x * Tau^2;
Zeta_y [1,1]	= 12.54627	- 0.693954*d_min_y - 0.084354*Tau + 4.24983 * K - 0.001892 * Rho - 2.20353 * v + 0.042799 * d_min_y * Tau + 0.184160*d_min_y * K + 0.000276*d_min_y * Rho	+ 0.157667*d_min_y * v - 0.115017	*Tau * K - 0.357980*Tau*v + 0.000089*K * Rho - 3.34267*K * v + 0.001447*Rho * v + 0.006495*d_min_y^2	+0.109795*Tau^2 - 0.007902*d_min_y * Tau * K + 0.014765*d_min_y * Tau * v - 0.000118*d_min_y * K * Rho - 0.083163*d_min_y * K * v - 0.000127*d_min_y * Rho * v + 0.002956*K * Rho * v - 0.005616*d_min_y * Tau^2;

R_SSA_p[1,1] = 10000; //0.01 because the lateral damping model gives as %
R_SSA_p[1,2] = 0;
R_SSA_p[1,3] = 0;
R_SSA_p[2,1] = 0;
R_SSA_p[2,2] = 10000;//0.01 because the lateral damping model gives as %
R_SSA_p[2,3] = 0;
R_SSA_p[3,1] = 0;
R_SSA_p[3,2] = 0;
R_SSA_p[3,3] = 0;

p.e = R_SSA_p * p.f;
implementation_end;
         Mass 768 424
          type i1
           ports
            power in p [3,1];
            signal out outp [3,1];
           restrictions
            causality preferred in p;
          end;
          icon bg bottom
           figures
            text 'I' 768 424 color 0 18 bold;
          end;
          implementation eq
//    Bond Graph I element
parameters
	real global	mass_p;	//  inductance
	
variables
	real	state[3];
	
equations
	state = int(p.e);
	p.f = state  ./ mass_p;
	outp = state;
implementation_end;
         plug p_VB_1 472 600;
         plug output 488 24;
         plug P 144 312;
         plug p 440 24;
         OneJunction 688 96
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 96 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction1 688 592
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 688 592 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction8 240 392
          description '<Information>
 <Description>
    <Version>4.2</Version>
<IsMainModel>1</IsMainModel>
  <KeepParameterValues>False</KeepParameterValues>
    <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2011-11-29 16:17:51</TimeStamp>
</Description>
</Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 392 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         R01 544 448
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type FillA011
           ports
            signal in CAng [3,1];
            signal out A [3,3];
          end;
          implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
         R01_vA1 635 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg top
           figures
            rectangle 613 154 657.1 214 color 0 fill 14013909;
            text 'R01' 635.1 184 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;
implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vB2 632 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 610 458 654 518 color 0 fill 14013909;
            text 'R01' 632 488 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         R01_vG1 659.1 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTA011
           ports
            power none PowOut [3,1];
            power none PowIn [3,1];
            signal in Cardan [3,1];
          end;
          icon bg bottom
           figures
            rectangle 637.1 306 681.1 366 color 0 fill 14013909;
            text 'R01' 659.1 336 color 0;
          end;
          implementation bg
           submodels
            MTF_R01 176 168
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 176 168 color 0 'Courier New' 18 bold;
              terminals
               p1 152 168 fixed;
               p2 200 168 fixed;
             end;
             implementation eq




equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
            plug PowOut 301.4 168;
            plug PowIn 45.3 168;
            plug Cardan 176 32;
            R01 176 96
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type FillA011
              ports
               signal in CAng [3,1];
               signal out A [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    2013/04/18	  Rideout
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
variables
	real	cphi;
	real	sphi;
	real	cth;
	real	sth;
	real	cpsi;
	real	spsi;

equations
	cphi = cos(CAng[1]);
	sphi = sin(CAng[1]);
	cth = cos(CAng[2]);
	sth = sin(CAng[2]);
	cpsi = cos(CAng[3]);
	spsi = sin(CAng[3]);
	A[1, 1] = cth * cpsi;
	A[2, 1] = cphi * spsi + sphi * sth * cpsi;
	A[3, 1] = sphi * spsi - cphi * sth * cpsi;
	A[1, 2] = -cth * spsi;
	A[2, 2] = cphi * cpsi - sphi * sth * spsi;
	A[3, 2] = sphi * cpsi + cphi * sth * spsi;
	A[1, 3] = sth;
	A[2, 3] = -sphi * cth;
	A[3, 3] = cphi * cth;

implementation_end;
           end;
           connections
            Cardan -> R01\CAng;
            MTF_R01\p2 => PowOut;
            PowIn => MTF_R01\p1;
            R01\A -> MTF_R01\r;
           end;
          implementation_end;
         rA_G_1 299.1 168.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg left
           figures
            rectangle 283.1 152.2 315.1 184 color 0 fill 15132390;
            line 294.8 157 294.8 179 color 16711680 width 2;
            line 305.9 154.3 305.9 180 color 0;
            line 289.9 156.6 308.1 156.6 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real global	rA_Gp[3,1];	//  amplitude of output signal
equations
	output = rA_Gp;
implementation_end;
         rB_G_1 299.1 504
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type con1
           ports
            signal out output [3,1];
          end;
          icon bg bottom
           figures
            rectangle 283.1 488.1 315.1 519.9 color 0 fill 15132390;
            line 294.8 492.9 294.8 514.9 color 16711680 width 2;
            line 305.9 490.2 305.9 515.9 color 0;
            line 289.9 492.5 308.1 492.5 color 0;
          end;
          implementation eq
//    Constant signal source
variables
	real	global rB_Gp[3,1];	//  amplitude of output signal
equations
	output = rB_Gp;
implementation_end;
         RWB 616 96
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 96 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         RWB1 616 592
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\R.emx</LibraryPath><TimeStamp>2011-11-29 16:35:37</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type R
           ports
            power in p [3,1];
          end;
          icon bg bottom
           figures
            text 'R' 616 592 color 0 18 bold;
          end;
          implementation eq
parameters
	real global R_WB;
equations
	p.e = R_WB * p.f;
implementation_end;
         Splitter10 936 384
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 932.8 380.8 939.2 387.2 color -1 fill 0;
            ellipse 931.7 379.7 940.3 388.3 color -1;
           terminals
            input 936 384 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter2 600 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 332.8 603.2 339.2 color -1 fill 0;
            ellipse 595.7 331.7 604.3 340.3 color -1;
           terminals
            input 600 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter3 600 248
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 244.8 603.2 251.2 color -1 fill 0;
            ellipse 595.7 243.7 604.3 252.3 color -1;
           terminals
            input 600 248 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter4 600 416
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 596.8 412.8 603.2 419.2 color -1 fill 0;
            ellipse 595.7 411.7 604.3 420.3 color -1;
           terminals
            input 600 416 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter5 360 336
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 356.8 332.8 363.2 339.2 color -1 fill 0;
            ellipse 355.7 331.7 364.3 340.3 color -1;
           terminals
            input 360 336 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter7 712 184
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 180.8 715.2 187.2 color -1 fill 0;
            ellipse 707.7 179.7 716.3 188.3 color -1;
           terminals
            input 712 184 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Splitter9 712 488
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [3,1];
            signal knot in input [3,1];
          end;
          icon bg ellipse
           figures
            ellipse 708.8 484.8 715.2 491.2 color -1 fill 0;
            ellipse 707.7 483.7 716.3 492.3 color -1;
           terminals
            input 712 488 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         vA_0 688 184
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg top
           figures
            text '1' 688 184 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vA_1 464 184
          description '<Description>
 <Version>4.0</Version>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 464 184 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_1 464 488
          description '<Information><Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\OneJunction.emx</LibraryPath><TimeStamp>2007-9-27 9:51:18</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none p [3,1];
            signal knot out flow [3,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 464 488 color 0 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         vB_2 688 488
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 688 488 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_0 768 336
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg bottom
           figures
            text '1' 768 336 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         vG_1 464 288
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 464 288 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         WBContact 688 24
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 24 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
implementation_end;
         WBContact1 688 664
          description '<Information><Description><Version>4.2</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Bond Graph\C.emx</LibraryPath><TimeStamp>2011-11-29 15:58:35</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
          type C
           ports
            power in p [3,1];
            signal out state [3,1];
           restrictions
            causality preferred out p;
          end;
          icon bg bottom
           figures
            text 'C' 688 664 color 0 18 bold;
          end;
          implementation eq
parameters
	
	real global k_w; // Well bore contact stiffness
	real global r_w; // direct distance from the center of the element to the wall
	real global r_p_o; // Outer radius of the pipe
	
variables
	real del;
	
equations
	state = int(p.f);
	
	del = sqrt ( (state[1])^2 + (state[2])^2 ); // del is the displacement of the drill pipe inside the well bore in x and y directions
	if del < (r_w - r_p_o) then 
		p.e = 0;
	else
		p.e = k_w * ( del - (r_w - r_p_o) )*sign(state);
	end;
	
implementation_end;
         wxr 299 248.1
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 224.6 331 271.6 color 0 fill 12895428;
            text 'w X rA/G' 299 248.2 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 160 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq



equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         wxr1 299 432
          description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <Version>No Version Info</Version>
</Description>';
          type wxr
           ports
            power out PowOut [3,1];
            power in PowIn [3,1];
            signal in X [3,1];
          end;
          icon bg
           figures
            rectangle 267 408.6 331.1 455.5 color 0 fill 12895428;
            text 'w X rB/G' 299.1 432.1 color 0 16;
          end;
          implementation bg
           submodels
            CrossPr 164 80
             type FillX1
              ports
               signal in X [3,1];
               signal out Fmt [3,3];
             end;
             implementation eq
//  Owner: Camas
//  Change_Notes:
//    28/04/1994    Weustink    		Created
//    12/11/1994	  Groen, Weustink	Modified
//  General_Description:
//  Validity_Domain:
//  Modeling_Assumptions:
equations
	Fmt[1, 1] = 0;
	Fmt[1, 2] = X[3];
	Fmt[1, 3] = -X[2];
	Fmt[2, 1] = -X[3];
	Fmt[2, 2] = 0;
	Fmt[2, 3] = X[1];
	Fmt[3, 1] = X[2];
	Fmt[3, 2] = -X[1];
	Fmt[3, 3] = 0;
implementation_end;
            plug PowOut 288 104;
            plug PowIn 40 104;
            plug X 162.7 24;
            PowerIn 80 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 80 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            PowerOut 240 152
             knot OneJunction
              ports
               power knot duplicatable none P [3,1];
               signal knot out outp [3,1];
              restrictions
               causality constraint one_out P;
             end;
             icon bg
              figures
               text '1' 240 152 color 0 18 bold;
             end;
             implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
            wxr 160 152
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type 'MTF_act-3'
              ports
               power in p1 [3,1];
               power out p2 [3,1];
               signal in r [3,3];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 160 152 color 0 20 bold;
              terminals
               p1 136 152 fixed;
               p2 184 152 fixed;
             end;
             implementation eq

equations					
	p1.e = transpose (r) * p2.e;
	p2.f = r * p1.f;      

implementation_end;
           end;
           connections
            CrossPr\Fmt -> wxr\r;
            PowerIn\P => wxr\p1;
            PowerOut\P => PowOut;
            PowIn => PowerIn\P;
            wxr\p2 => PowerOut\P;
            X -> CrossPr\X;
           end;
          implementation_end;
         w_1 299.1 336.1
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none P [3,1];
            signal knot out outp [3,1];
           restrictions
            causality constraint one_out P;
          end;
          icon bg left
           figures
            text '1' 299.1 336.1 color 0 18 bold;
          end;
          implementation eq
equations
sum (direct (P.e)) = 0;
equal (collect (P.f));
outp = first (P.f);
implementation_end;
         X_A 760 64
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 195.72];
          end;
          icon bg bottom
           figures
            rectangle 744 48 776 80 color 0 fill 15132390;
            text 'ò' 757.3 64 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_B1 760 584
          description '<Information><Description><Version>No Version Info</Version><IsMainModel>0</IsMainModel><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration></Configuration></Description></Information>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 32.5];
          end;
          icon bg bottom
           figures
            rectangle 744 568 776 600 color 0 fill 15132390;
            text 'ò' 757.3 584 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
         X_G 856 368
          description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input [3,1];
            signal out output [3,1];
           parameters
            real initial[3,1] = [0.0; 0.0; 0.0];
          end;
          icon bg bottom
           figures
            rectangle 840 352 872 384 color 0 fill 15132390;
            text '∫' 853.3 368 color 16711680 'SymbolProp BT' 21;
          end;
          implementation eq
equations
	output = int (input, initial);
     implementation_end;
        end;
        connections
         Body3_213\RotAng -> Splitter2\input;
         F_A1\P => vB_1\p;
         F_A10\P => vA_1\p;
         Fz1\p => vG_0\P;
         LateralDampingModel\p <= vG_0\P;
         OneJunction\p => RWB\p;
         OneJunction\p => vA_0\P;
         OneJunction\p => WBContact\p;
         OneJunction1\p => RWB1\p;
         OneJunction1\p => vB_2\P;
         OneJunction1\p => WBContact1\p;
         OneJunction8\p => w_1\P;
         R01_vA1\PowOut => vA_0\P;
         R01_vB2\PowOut => vB_2\P;
         R01_vG1\PowOut => vG_0\P;
         R01\A -> Gain\R01;
         rA_G_1\output -> wxr\X;
         rB_G_1\output -> wxr1\X;
         Splitter10\output -> Fz1\eccentricity;
         Splitter10\output -> LateralDampingModel\eccentricity 936 384;
         Splitter2\output -> R01_vG1\Cardan;
         Splitter2\output -> R01\CAng;
         Splitter2\output -> Splitter3\input;
         Splitter2\output -> Splitter4\input;
         Splitter3\output -> output;
         Splitter3\output -> R01_vA1\Cardan;
         Splitter4\output -> R01_vB2\Cardan;
         Splitter5\output -> Body3_213\w;
         Splitter5\output -> Gain\input 400 376;
         Splitter7\output -> X_A\input 712 64;
         Splitter9\output -> X_B1\input 712 584;
         vA_0\outp -> Splitter7\input;
         vA_1\p <= p;
         vA_1\p => R01_vA1\PowIn;
         vB_1\p => p_VB_1;
         vB_1\p => R01_vB2\PowIn;
         vB_2\outp -> Splitter9\input;
         vG_0\outp -> X_G\input;
         vG_0\P => Mass\p;
         vG_1\P => F_A1\P;
         vG_1\P => F_A10\P;
         vG_1\P => R01_vG1\PowIn 576 288;
         w_1\outp -> Splitter5\input;
         w_1\P <= P;
         w_1\P => Gyro\P;
         w_1\P => J\p;
         w_1\P => wxr\PowIn;
         w_1\P => wxr1\PowIn;
         wxr\PowOut => F_A10\P;
         wxr1\PowOut => F_A1\P;
         X_G\output -> Splitter10\input;
        end;
       implementation_end;
      plug Om_B10 56 104;
      plug V_B10 248 96;
      plug input 152 49;
      plug P_VB_1 152 288;
     end;
     connections
      input -> Interface_31\input;
      Interface_31\p => Last_Element\p 240 144 240 184;
      Interface_31\p1 => Last_Element\P 64 144 64 184;
      Last_Element\output -> Interface_31\input1;
      Last_Element\p_VB_1 => P_VB_1;
      Om_B10 => Interface_31\Om_B10;
      V_B10 => Interface_31\V_B10;
     end;
    implementation_end;
   OneJunction1 248 32
    knot OneJunction
     ports
      power knot duplicatable none p [3,1];
      signal knot out flow [3,1];
     restrictions
      causality constraint one_out p;
    end;
    icon bg
     figures
      text '1' 248 32 color 0 18 bold;
    end;
    implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
   OneJunction2 248 528
    knot OneJunction
     ports
      power knot duplicatable none p [3,1];
      signal knot out flow [3,1];
     restrictions
      causality constraint one_out p;
    end;
    icon bg
     figures
      text '1' 248 528 color 0 18 bold;
    end;
    implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
   R1 336 32
    type 'R-3'
     ports
      power in p [3,1];
     parameters
      real r[3,3] = [1.0e6, 0.0, 0.0; 0.0, 1.0e6, 0.0; 0.0, 0.0, 1.0e6];
    end;
    icon bg bottom
     figures
      text 'R' 336 32 color 0 18 bold;
    end;
    implementation eq
equations					
	p.e = r * p.f;      implementation_end;
   R2 336 528
    type 'R-3'
     ports
      power in p [3,1];
     parameters
      real r[3,3] = [1.0e6, 0.0, 0.0; 0.0, 1.0e6, 0.0; 0.0, 0.0, 1.0e6];
    end;
    icon bg bottom
     figures
      text 'R' 336 528 color 0 18 bold;
    end;
    implementation eq
equations					
	p.e = r * p.f;      implementation_end;
   Rho 608 136
			specifications active 'frequency_limited_FOH'
				specification 'frequency_limited_FOH'
 description '<Information><Description><Version>4.1</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath><TimeStamp>2009-6-18 15:46:03</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 592 120 624 152 color 0 fill 15132390;
    text 'FOH' 613.7 147 color 0 8 bold;
    line 596.3 131.9 599.2 130.7 600 128 601.3 126.3 602.7 141.5 604.2 143.2 605.5 129.7 606.8 128.8 608.7 139.7 611.5 141.8 613 127.5 614 125.5 615.2 129 615.5 133.2 617.5 134.5 619.9 134.6 color 16711680;
    line 622.1 136 593.3 136 color 0;
    line 596.5 126.4 596.5 145.6 color 0;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1500;			
	real seed = 1000;					
	real frequency = 1 {Hz};		// hold frequency on output
variables
	real hidden t_hit {s}, h {s}, dt {s};
	real hidden buffer, buffer_hit, slope;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
	buffer_hit = ran (amplitude, seed);
	slope = (buffer_hit - buffer) / h;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = buffer_hit;
		buffer_hit = ran (amplitude,seed);
		slope = (buffer_hit - buffer) / h;
	end;
	dt = t_hit - time;
	output = if (dt == 0) then 
		buffer 
	else 
		buffer + slope * (h - dt) end;
implementation_end;
specification_end;
				specification 'frequency_limited_ZOH'
description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 232 192 264 224 fill 15132390;
    line 236.5 198.4 236.5 217.6;
    line 262.1 208 233.3 208;
    line 236.3 203.9 239.8 204 239.8 198.2 242.7 198.3 242.7 215.3 245.3 215.5 245.5 201.7 248.7 201.8 248.7 211.7 253 211.8 253 199.5 255.2 199.5 255.3 196 257.7 195.8 257.5 206.5 259.9 206.6 color 16711680;
    text 'ZOH' 253.7 219 8 bold;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1.0;			
	real seed = 0.0;					
	real frequency = 100.0 {Hz};		// ZOH frequency on output
variables
	real hidden t_hit {s}, h {s};
	real hidden buffer;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = ran (amplitude,seed);
	end;
	output = buffer;
implementation_end;
specification_end;
				specification 'unlimited'
description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
  <TimeStamp>2009-6-17 13:48:54</TimeStamp>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   rectangle 232 192 264 224 fill 15132390;
   line 236.5 198.4 236.5 217.6;
   line 262.1 208 233.3 208;
   line 236.3 203.9 238.1 198.4 240 206.6 241.8 197.9 243.7 217.8 245.3 211.2 246.4 205.3 248.7 200 250.9 220.3 252.3 216.7 253 203.2 254.6 206.9 255.5 197 257.1 200 258.9 196.5 259.9 206.6 color 16711680;
 end;
 implementation eq
parameters
	real amplitude = 1.0;
	real seed = 0.0;
equations
	output = ran (amplitude,seed);
      implementation_end;
specification_end;
			end;
   Tau 608 200
			specifications active 'frequency_limited_FOH'
				specification 'frequency_limited_FOH'
 description '<Information><Description><Version>4.1</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath><TimeStamp>2009-6-18 15:46:03</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 592 184 624 216 color 0 fill 15132390;
    text 'FOH' 613.7 211 color 0 8 bold;
    line 596.3 195.9 599.2 194.7 600 192 601.3 190.3 602.7 205.5 604.2 207.2 605.5 193.7 606.8 192.8 608.7 203.7 611.5 205.8 613 191.5 614 189.5 615.2 193 615.5 197.2 617.5 198.5 619.9 198.6 color 16711680;
    line 622.1 200 593.3 200 color 0;
    line 596.5 190.4 596.5 209.6 color 0;
   end;
 end;
 implementation eq
parameters
	real amplitude = 10;			
	real seed = 0.0;					
	real frequency = 0.75 {Hz};		// hold frequency on output
variables
	real hidden t_hit {s}, h {s}, dt {s};
	real hidden buffer, buffer_hit, slope;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
	buffer_hit = ran (amplitude, seed);
	slope = (buffer_hit - buffer) / h;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = buffer_hit;
		buffer_hit = ran (amplitude,seed);
		slope = (buffer_hit - buffer) / h;
	end;
	dt = t_hit - time;
	output = if (dt == 0) then 
		buffer 
	else 
		buffer + slope * (h - dt) end;
implementation_end;
specification_end;
				specification 'frequency_limited_ZOH'
description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 232 192 264 224 fill 15132390;
    line 236.5 198.4 236.5 217.6;
    line 262.1 208 233.3 208;
    line 236.3 203.9 239.8 204 239.8 198.2 242.7 198.3 242.7 215.3 245.3 215.5 245.5 201.7 248.7 201.8 248.7 211.7 253 211.8 253 199.5 255.2 199.5 255.3 196 257.7 195.8 257.5 206.5 259.9 206.6 color 16711680;
    text 'ZOH' 253.7 219 8 bold;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1.0;			
	real seed = 0.0;					
	real frequency = 100.0 {Hz};		// ZOH frequency on output
variables
	real hidden t_hit {s}, h {s};
	real hidden buffer;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = ran (amplitude,seed);
	end;
	output = buffer;
implementation_end;
specification_end;
				specification 'unlimited'
description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
  <TimeStamp>2009-6-17 13:48:54</TimeStamp>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   rectangle 232 192 264 224 fill 15132390;
   line 236.5 198.4 236.5 217.6;
   line 262.1 208 233.3 208;
   line 236.3 203.9 238.1 198.4 240 206.6 241.8 197.9 243.7 217.8 245.3 211.2 246.4 205.3 248.7 200 250.9 220.3 252.3 216.7 253 203.2 254.6 206.9 255.5 197 257.1 200 258.9 196.5 259.9 206.6 color 16711680;
 end;
 implementation eq
parameters
	real amplitude = 1.0;
	real seed = 0.0;
equations
	output = ran (amplitude,seed);
      implementation_end;
specification_end;
			end;
   v 608 80
			specifications active 'frequency_limited_FOH'
				specification 'frequency_limited_FOH'
 description '<Information><Description><Version>4.1</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath><TimeStamp>2009-6-18 15:46:03</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description></Information>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 592 64 624 96 color 0 fill 15132390;
    text 'FOH' 613.7 91 color 0 8 bold;
    line 596.3 75.9 599.2 74.7 600 72 601.3 70.3 602.7 85.5 604.2 87.2 605.5 73.7 606.8 72.8 608.7 83.7 611.5 85.8 613 71.5 614 69.5 615.2 73 615.5 77.2 617.5 78.5 619.9 78.6 color 16711680;
    line 622.1 80 593.3 80 color 0;
    line 596.5 70.4 596.5 89.6 color 0;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1.5;			
	real seed = 0;					
	real frequency = 2 {Hz};		// hold frequency on output
variables
	real hidden t_hit {s}, h {s}, dt {s};
	real hidden buffer, buffer_hit, slope;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
	buffer_hit = ran (amplitude, seed);
	slope = (buffer_hit - buffer) / h;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = buffer_hit;
		buffer_hit = ran (amplitude,seed);
		slope = (buffer_hit - buffer) / h;
	end;
	dt = t_hit - time;
	output = if (dt == 0) then 
		buffer 
	else 
		buffer + slope * (h - dt) end;
implementation_end;
specification_end;
				specification 'frequency_limited_ZOH'
description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   group
    rectangle 232 192 264 224 fill 15132390;
    line 236.5 198.4 236.5 217.6;
    line 262.1 208 233.3 208;
    line 236.3 203.9 239.8 204 239.8 198.2 242.7 198.3 242.7 215.3 245.3 215.5 245.5 201.7 248.7 201.8 248.7 211.7 253 211.8 253 199.5 255.2 199.5 255.3 196 257.7 195.8 257.5 206.5 259.9 206.6 color 16711680;
    text 'ZOH' 253.7 219 8 bold;
   end;
 end;
 implementation eq
parameters
	real amplitude = 1.0;			
	real seed = 0.0;					
	real frequency = 100.0 {Hz};		// ZOH frequency on output
variables
	real hidden t_hit {s}, h {s};
	real hidden buffer;		
	boolean hidden hit; 	
initialequations
	h = 1 / frequency;
	t_hit = 0;
	buffer = 0;
code
	hit = major and (time >= t_hit);
	if hit then
		t_hit = time + h;
		buffer = ran (amplitude,seed);
	end;
	output = buffer;
implementation_end;
specification_end;
				specification 'unlimited'
description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\SignalGenerator-Random.emx</LibraryPath>
  <TimeStamp>2009-6-17 13:48:54</TimeStamp>
</Description>';
 type 'SignalGenerator-Random'
  ports
   signal out output;
 end;
 icon bg bottom
  figures
   rectangle 232 192 264 224 fill 15132390;
   line 236.5 198.4 236.5 217.6;
   line 262.1 208 233.3 208;
   line 236.3 203.9 238.1 198.4 240 206.6 241.8 197.9 243.7 217.8 245.3 211.2 246.4 205.3 248.7 200 250.9 220.3 252.3 216.7 253 203.2 254.6 206.9 255.5 197 257.1 200 258.9 196.5 259.9 206.6 color 16711680;
 end;
 implementation eq
parameters
	real amplitude = 1.0;
	real seed = 0.0;
equations
	output = ran (amplitude,seed);
      implementation_end;
specification_end;
			end;
  end;
  connections
   FEB_01\Cardan_OUT -> FEB_02\Cardan_IN;
   FEB_01\om_B10_OUT => FEB_02\Om_B10_IN 160 232 160 256;
   FEB_01\v_B10_OUT => FEB_02\V_B10_IN 320 224 320 256;
   FEB_02\Cardan_OUT -> FEB_03\Cardan_IN;
   FEB_02\om_B10_OUT => FEB_03\Om_B10_IN 152 296 152 328;
   FEB_02\v_B10_OUT => FEB_03\V_B10_IN 344 288 344 320;
   FEB_03\Cardan_OUT -> FEB_04\Cardan_IN;
   FEB_03\om_B10_OUT => FEB_04\Om_B10_IN 152 352 152 384;
   FEB_03\v_B10_OUT => FEB_04\V_B10_IN 344 352 344 384;
   FEB_04\om_B10_OUT => Last_Element\Om_B10 152 416 152 456;
   FEB_04\v_B10_OUT => Last_Element\V_B10 328 424 328 456;
   First_Element\output -> FEB_01\Cardan_IN;
   First_Element\p => FEB_01\V_B10_IN 320 152 320 200;
   First_Element\P => OneJunction1\p;
   First_Element\P1 => FEB_01\Om_B10_IN 168 168 168 208;
   Gain\output -> Definitions\v_in;
   Gain1\output -> Definitions\Rho_in;
   Gain2\output -> Definitions\Tau_in;
   Gain3\output -> Definitions\K_in;
   K\output -> Gain3\input;
   Last_Element\input <- FEB_04\Cardan_OUT;
   Last_Element\P_VB_1 => OneJunction2\p;
   OneJunction1\p => C1\p;
   OneJunction2\p => C2\p;
   R1\p <= OneJunction1\p;
   R2\p <= OneJunction2\p;
   Rho\output -> Gain1\input;
   Tau\output -> Gain2\input;
   v\output -> Gain\input;
  end;
  figures
   text 'FEB: Five Elements Block' 496 392 color 0 16;
   text 'Impulse on 10th
' 472 368 color 0 16;
   text 'Note:' 416 312 color 0 16;
   text 'Effort source in the first element to rotate the drill string
' 576 344 color 0 16;
 implementation_end;
]]>
</Sidops>
 </Model>
 <Experiments>
     <DefaultExperiment><![CDATA[Converted Experiment]]>
</DefaultExperiment>
  <Experiment>
    <Name>Converted Experiment</Name>
    <CreatedBy></CreatedBy>
    <Info></Info>
<ExpData>
  <VersionNumber>4.8</VersionNumber>
  <ModelProperties>
    <ModelProperty section="tools\linearization" entry="useSymbolic" value="0"/>
    <ModelProperty section="tools\linearization" entry="inputName" value="First_Element\MSe\p.f[3]"/>
    <ModelProperty section="tools\linearization" entry="outputName" value="FEB_03\Interface_15\K\p.e[1]"/>
  </ModelProperties>
  <Variables>
   <Parameters>
    <Variable>
     <Name>V</Name>
     <Description><![CDATA[(Volume of an element)]]>
</Description>
     <Value>0.0252</Value>
    </Variable>
   </Parameters>
   <Initials>
    <Variable>
     <Name>C1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>C2\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_03\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_03\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_03\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_03\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_03\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_04\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_04\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_04\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_04\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_04\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_05\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_05\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_05\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_05\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_05\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_06\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_06\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_06\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_06\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_06\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_01\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_01\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_02\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_02\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_03\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_03\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_04\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_04\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_05\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Interface_05\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_07\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_07\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_07\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_07\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_07\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_08\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_08\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_08\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_08\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_08\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_09\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_09\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_09\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_09\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_09\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_10\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_10\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_10\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_10\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_10\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\K_Par_Rot1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\mc1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Element_11\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_06\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_06\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_07\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_07\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_08\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_08\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_09\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_09\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_10\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_02\Interface_10\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_12\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_12\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_12\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_12\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_12\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_13\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_13\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_13\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_13\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_13\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_14\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_14\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_14\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_14\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_14\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_15\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_15\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_15\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_15\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_15\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_16\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_16\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_16\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_16\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Element_16\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_11\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_11\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_12\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_12\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_13\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_13\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_14\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_14\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_15\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_03\Interface_15\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_17\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_17\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_17\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_17\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_17\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_18\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_18\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_18\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_18\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_18\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_19\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_19\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_19\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_19\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_19\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_20\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_20\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_20\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_20\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_20\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_21\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_21\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_21\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_21\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Element_21\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_16\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_16\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_17\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_17\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_18\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_18\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_19\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_19\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_20\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_04\Interface_20\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\PIDCntroller\pdstate_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\PIDCntroller\pistate_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Interface_31\Kt\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Interface_31\K\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Last_Element\Body3_213\intgrl\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Last_Element\J\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Last_Element\Mass\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Last_Element\WBContact1\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Last_Element\Last_Element\WBContact\state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\J\p.e_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>FEB_01\Element_02\w_1\P1.e_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>First_Element\Body3_213\RotAngDot\RotAngDot_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
   </Initials>
  </Variables>
  <PlotSpecs>
   <VarNames>
    <VarName>time</VarName>
    <VarName>First_Element\R01\A[1,3]</VarName>
    <VarName>First_Element\R01\A[2,3]</VarName>
    <VarName>First_Element\R01\A[3,3]</VarName>
    <VarName>First_Element\R01\A[1,2]</VarName>
    <VarName>First_Element\R01\A[2,2]</VarName>
    <VarName>First_Element\R01\A[3,2]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[1,3]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[2,3]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[3,3]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[1,2]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[2,2]</VarName>
    <VarName>Last_Element\Last_Element\R01\A[3,2]</VarName>
    <VarName>First_Element\X_A1\output[1]</VarName>
    <VarName>First_Element\X_A1\output[2]</VarName>
    <VarName>First_Element\X_A1\output[3]</VarName>
    <VarName>FEB_02\Element_07\X_A1\output[1]</VarName>
    <VarName>FEB_02\Element_07\X_A1\output[2]</VarName>
    <VarName>FEB_02\Element_07\X_A1\output[3]</VarName>
    <VarName>FEB_02\Element_08\X_A\output[1]</VarName>
    <VarName>FEB_02\Element_08\X_A\output[2]</VarName>
    <VarName>FEB_02\Element_08\X_A\output[3]</VarName>
    <VarName>FEB_02\Element_09\X_A1\output[1]</VarName>
    <VarName>FEB_02\Element_09\X_A1\output[2]</VarName>
    <VarName>FEB_02\Element_09\X_A1\output[3]</VarName>
    <VarName>FEB_02\Element_10\X_A\output[1]</VarName>
    <VarName>FEB_02\Element_10\X_A\output[2]</VarName>
    <VarName>FEB_02\Element_10\X_A\output[3]</VarName>
    <VarName>FEB_02\Element_11\X_A1\output[1]</VarName>
    <VarName>FEB_02\Element_11\X_A1\output[2]</VarName>
    <VarName>FEB_02\Element_11\X_A1\output[3]</VarName>
    <VarName>FEB_03\Element_12\X_A\output[1]</VarName>
    <VarName>FEB_03\Element_12\X_A\output[2]</VarName>
    <VarName>FEB_03\Element_12\X_A\output[3]</VarName>
    <VarName>FEB_03\Element_13\X_A1\output[1]</VarName>
    <VarName>FEB_03\Element_13\X_A1\output[2]</VarName>
    <VarName>FEB_03\Element_13\X_A1\output[3]</VarName>
    <VarName>FEB_03\Element_14\X_A\output[1]</VarName>
    <VarName>FEB_03\Element_14\X_A\output[2]</VarName>
    <VarName>FEB_03\Element_14\X_A\output[3]</VarName>
    <VarName>FEB_03\Element_15\X_A1\output[1]</VarName>
    <VarName>FEB_03\Element_15\X_A1\output[2]</VarName>
    <VarName>FEB_03\Element_15\X_A1\output[3]</VarName>
    <VarName>FEB_03\Element_16\X_A\output[1]</VarName>
    <VarName>FEB_03\Element_16\X_A\output[2]</VarName>
    <VarName>FEB_03\Element_16\X_A\output[3]</VarName>
    <VarName>FEB_04\Element_17\X_A1\output[1]</VarName>
    <VarName>FEB_04\Element_17\X_A1\output[2]</VarName>
    <VarName>FEB_04\Element_17\X_A1\output[3]</VarName>
    <VarName>FEB_04\Element_18\X_A\output[1]</VarName>
    <VarName>FEB_04\Element_18\X_A\output[2]</VarName>
    <VarName>FEB_04\Element_18\X_A\output[3]</VarName>
    <VarName>FEB_04\Element_19\X_A1\output[1]</VarName>
    <VarName>FEB_04\Element_19\X_A1\output[2]</VarName>
    <VarName>FEB_04\Element_19\X_A1\output[3]</VarName>
    <VarName>FEB_04\Element_20\X_A\output[1]</VarName>
    <VarName>FEB_04\Element_20\X_A\output[2]</VarName>
    <VarName>FEB_04\Element_20\X_A\output[3]</VarName>
    <VarName>FEB_04\Element_21\X_A1\output[1]</VarName>
    <VarName>FEB_04\Element_21\X_A1\output[2]</VarName>
    <VarName>FEB_04\Element_21\X_A1\output[3]</VarName>
    <VarName>Last_Element\Last_Element\X_A\output[1]</VarName>
    <VarName>Last_Element\Last_Element\X_A\output[2]</VarName>
    <VarName>Last_Element\Last_Element\X_A\output[3]</VarName>
    <VarName>FEB_01\Element_02\R01\A[1,3]</VarName>
    <VarName>FEB_01\Element_02\R01\A[2,3]</VarName>
    <VarName>FEB_01\Element_02\R01\A[3,3]</VarName>
    <VarName>FEB_01\Element_02\R01\A[1,2]</VarName>
    <VarName>FEB_01\Element_02\R01\A[2,2]</VarName>
    <VarName>FEB_01\Element_02\R01\A[3,2]</VarName>
    <VarName>FEB_01\Element_03\R01\A[1,3]</VarName>
    <VarName>FEB_01\Element_03\R01\A[2,3]</VarName>
    <VarName>FEB_01\Element_03\R01\A[3,3]</VarName>
    <VarName>FEB_01\Element_03\R01\A[1,2]</VarName>
    <VarName>FEB_01\Element_03\R01\A[2,2]</VarName>
    <VarName>FEB_01\Element_03\R01\A[3,2]</VarName>
    <VarName>FEB_01\Element_04\R01\A[1,3]</VarName>
    <VarName>FEB_01\Element_04\R01\A[2,3]</VarName>
    <VarName>FEB_01\Element_04\R01\A[3,3]</VarName>
    <VarName>FEB_01\Element_04\R01\A[1,2]</VarName>
    <VarName>FEB_01\Element_04\R01\A[2,2]</VarName>
    <VarName>FEB_01\Element_04\R01\A[3,2]</VarName>
    <VarName>FEB_01\Element_05\R01\A[1,3]</VarName>
    <VarName>FEB_01\Element_05\R01\A[2,3]</VarName>
    <VarName>FEB_01\Element_05\R01\A[3,3]</VarName>
    <VarName>FEB_01\Element_05\R01\A[1,2]</VarName>
    <VarName>FEB_01\Element_05\R01\A[2,2]</VarName>
    <VarName>FEB_01\Element_05\R01\A[3,2]</VarName>
    <VarName>FEB_01\Element_06\R01\A[1,3]</VarName>
    <VarName>FEB_01\Element_06\R01\A[2,3]</VarName>
    <VarName>FEB_01\Element_06\R01\A[3,3]</VarName>
    <VarName>FEB_01\Element_06\R01\A[1,2]</VarName>
    <VarName>FEB_01\Element_06\R01\A[2,2]</VarName>
    <VarName>FEB_01\Element_06\R01\A[3,2]</VarName>
    <VarName>FEB_02\Element_07\R01\A[1,3]</VarName>
    <VarName>FEB_02\Element_07\R01\A[2,3]</VarName>
    <VarName>FEB_02\Element_07\R01\A[3,3]</VarName>
    <VarName>FEB_02\Element_07\R01\A[1,2]</VarName>
    <VarName>FEB_02\Element_07\R01\A[2,2]</VarName>
    <VarName>FEB_02\Element_07\R01\A[3,2]</VarName>
    <VarName>FEB_02\Element_08\R01\A[1,3]</VarName>
    <VarName>FEB_02\Element_08\R01\A[2,3]</VarName>
    <VarName>FEB_02\Element_08\R01\A[3,3]</VarName>
    <VarName>FEB_02\Element_08\R01\A[1,2]</VarName>
    <VarName>FEB_02\Element_08\R01\A[2,2]</VarName>
    <VarName>FEB_02\Element_08\R01\A[3,2]</VarName>
    <VarName>FEB_02\Element_09\R01\A[1,3]</VarName>
    <VarName>FEB_02\Element_09\R01\A[2,3]</VarName>
    <VarName>FEB_02\Element_09\R01\A[3,3]</VarName>
    <VarName>FEB_02\Element_09\R01\A[1,2]</VarName>
    <VarName>FEB_02\Element_09\R01\A[2,2]</VarName>
    <VarName>FEB_02\Element_09\R01\A[3,2]</VarName>
    <VarName>FEB_02\Element_10\R01\A[1,3]</VarName>
    <VarName>FEB_02\Element_10\R01\A[2,3]</VarName>
    <VarName>FEB_02\Element_10\R01\A[3,3]</VarName>
    <VarName>FEB_02\Element_10\R01\A[1,2]</VarName>
    <VarName>FEB_02\Element_10\R01\A[2,2]</VarName>
    <VarName>FEB_02\Element_10\R01\A[3,2]</VarName>
    <VarName>FEB_02\Element_11\R01\A[1,3]</VarName>
    <VarName>FEB_02\Element_11\R01\A[2,3]</VarName>
    <VarName>FEB_02\Element_11\R01\A[3,3]</VarName>
    <VarName>FEB_02\Element_11\R01\A[1,2]</VarName>
    <VarName>FEB_02\Element_11\R01\A[2,2]</VarName>
    <VarName>FEB_02\Element_11\R01\A[3,2]</VarName>
    <VarName>FEB_03\Element_12\R01\A[1,3]</VarName>
    <VarName>FEB_03\Element_12\R01\A[2,3]</VarName>
    <VarName>FEB_03\Element_12\R01\A[3,3]</VarName>
    <VarName>FEB_03\Element_12\R01\A[1,2]</VarName>
    <VarName>FEB_03\Element_12\R01\A[2,2]</VarName>
    <VarName>FEB_03\Element_12\R01\A[3,2]</VarName>
    <VarName>FEB_03\Element_13\R01\A[1,3]</VarName>
    <VarName>FEB_03\Element_13\R01\A[2,3]</VarName>
    <VarName>FEB_03\Element_13\R01\A[3,3]</VarName>
    <VarName>FEB_03\Element_13\R01\A[1,2]</VarName>
    <VarName>FEB_03\Element_13\R01\A[2,2]</VarName>
    <VarName>FEB_03\Element_13\R01\A[3,2]</VarName>
    <VarName>FEB_03\Element_14\R01\A[1,3]</VarName>
    <VarName>FEB_03\Element_14\R01\A[2,3]</VarName>
    <VarName>FEB_03\Element_14\R01\A[3,3]</VarName>
    <VarName>FEB_03\Element_14\R01\A[1,2]</VarName>
    <VarName>FEB_03\Element_14\R01\A[2,2]</VarName>
    <VarName>FEB_03\Element_14\R01\A[3,2]</VarName>
    <VarName>FEB_03\Element_15\R01\A[1,3]</VarName>
    <VarName>FEB_03\Element_15\R01\A[2,3]</VarName>
    <VarName>FEB_03\Element_15\R01\A[3,3]</VarName>
    <VarName>FEB_03\Element_15\R01\A[1,2]</VarName>
    <VarName>FEB_03\Element_15\R01\A[2,2]</VarName>
    <VarName>FEB_03\Element_15\R01\A[3,2]</VarName>
    <VarName>FEB_03\Element_16\R01\A[1,3]</VarName>
    <VarName>FEB_03\Element_16\R01\A[2,3]</VarName>
    <VarName>FEB_03\Element_16\R01\A[3,3]</VarName>
    <VarName>FEB_03\Element_16\R01\A[1,2]</VarName>
    <VarName>FEB_03\Element_16\R01\A[2,2]</VarName>
    <VarName>FEB_03\Element_16\R01\A[3,2]</VarName>
    <VarName>FEB_04\Element_17\R01\A[1,3]</VarName>
    <VarName>FEB_04\Element_17\R01\A[2,3]</VarName>
    <VarName>FEB_04\Element_17\R01\A[3,3]</VarName>
    <VarName>FEB_04\Element_17\R01\A[1,2]</VarName>
    <VarName>FEB_04\Element_17\R01\A[2,2]</VarName>
    <VarName>FEB_04\Element_17\R01\A[3,2]</VarName>
    <VarName>FEB_04\Element_18\R01\A[1,3]</VarName>
    <VarName>FEB_04\Element_18\R01\A[2,3]</VarName>
    <VarName>FEB_04\Element_18\R01\A[3,3]</VarName>
    <VarName>FEB_04\Element_18\R01\A[1,2]</VarName>
    <VarName>FEB_04\Element_18\R01\A[2,2]</VarName>
    <VarName>FEB_04\Element_18\R01\A[3,2]</VarName>
    <VarName>FEB_04\Element_19\R01\A[1,3]</VarName>
    <VarName>FEB_04\Element_19\R01\A[2,3]</VarName>
    <VarName>FEB_04\Element_19\R01\A[3,3]</VarName>
    <VarName>FEB_04\Element_19\R01\A[1,2]</VarName>
    <VarName>FEB_04\Element_19\R01\A[2,2]</VarName>
    <VarName>FEB_04\Element_19\R01\A[3,2]</VarName>
    <VarName>FEB_04\Element_20\R01\A[1,3]</VarName>
    <VarName>FEB_04\Element_20\R01\A[2,3]</VarName>
    <VarName>FEB_04\Element_20\R01\A[3,3]</VarName>
    <VarName>FEB_04\Element_20\R01\A[1,2]</VarName>
    <VarName>FEB_04\Element_20\R01\A[2,2]</VarName>
    <VarName>FEB_04\Element_20\R01\A[3,2]</VarName>
    <VarName>FEB_04\Element_21\R01\A[1,3]</VarName>
    <VarName>FEB_04\Element_21\R01\A[2,3]</VarName>
    <VarName>FEB_04\Element_21\R01\A[3,3]</VarName>
    <VarName>FEB_04\Element_21\R01\A[1,2]</VarName>
    <VarName>FEB_04\Element_21\R01\A[2,2]</VarName>
    <VarName>FEB_04\Element_21\R01\A[3,2]</VarName>
    <VarName>FEB_01\Element_02\X_A1\output[1]</VarName>
    <VarName>FEB_01\Element_02\X_A1\output[2]</VarName>
    <VarName>FEB_01\Element_02\X_A1\output[3]</VarName>
    <VarName>FEB_01\Element_03\X_A\output[1]</VarName>
    <VarName>FEB_01\Element_03\X_A\output[2]</VarName>
    <VarName>FEB_01\Element_03\X_A\output[3]</VarName>
    <VarName>FEB_01\Element_04\X_A1\output[1]</VarName>
    <VarName>FEB_01\Element_04\X_A1\output[2]</VarName>
    <VarName>FEB_01\Element_04\X_A1\output[3]</VarName>
    <VarName>FEB_01\Element_05\X_A\output[1]</VarName>
    <VarName>FEB_01\Element_05\X_A\output[2]</VarName>
    <VarName>FEB_01\Element_05\X_A\output[3]</VarName>
    <VarName>FEB_01\Element_06\X_A1\output[1]</VarName>
    <VarName>FEB_01\Element_06\X_A1\output[2]</VarName>
    <VarName>FEB_01\Element_06\X_A1\output[3]</VarName>
    <VarName>FEB_02\Element_10\Pulse\output[1]</VarName>
    <VarName>FEB_03\Element_13\LateralDampingModel\d_min_x</VarName>
    <VarName>Definitions\v_in</VarName>
    <VarName>Definitions\K_in</VarName>
    <VarName>Definitions\Rho_in</VarName>
    <VarName>Definitions\Tau_in</VarName>
    <VarName>FEB_03\Element_13\LateralDampingModel\R_SSA_p[1,1]</VarName>
    <VarName>FEB_03\Interface_13\Kt\p.e[1]</VarName>
    <VarName>C1\p.e[3]</VarName>
    <VarName>FEB_02\Element_11\WBContact\p.e[1]</VarName>
   </VarNames>
   <Plots>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>1</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Bending Moment (Ele 13- Ele 14)</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-150.0</Minimum>
       <Maximum>350.0</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Bending Moment (Nm) vs. Time (s)</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>9342520</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>9342520</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>10</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>FEB_03\Interface_13\Kt\p.e[1]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <Position>
       <X>0.6340956340956341</X>
       <Y>0.13547763008409858</Y>
      </Position>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>D3DPlot</PlotType>
     <BasePlot>
       <PlotId>2</PlotId>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>15790320</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <PlotTitle>3D Animation</PlotTitle>
     <RenderQuality>137</RenderQuality>
     <ShowGrid>false</ShowGrid>
     <ShowFPS>false</ShowFPS>
     <BackgroundColor>4278190130</BackgroundColor>
     <FrameScale>1.0</FrameScale>
     <FrameThickness>1.0</FrameThickness>
     <MainFrame>
      <Frame>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </ScaleValue>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Reference Frame</Name>
       <Position>
       </Position>
       <Orientation>
        <Angles>
        </Angles>
        <OrientationType>Bryant</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Default Lights and Cameras</Name>
         <Position>
         </Position>
         <Orientation>
     <Angles>
     </Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Ambient Light</Name>
      <Position>
      </Position>
      <Orientation>
       <Angles>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>0</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>0.392157</Value>
        </X>
        <Y>
         <Value>0.392157</Value>
        </Y>
        <Z>
         <Value>0.392157</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <AmbientLight>
       <Color>
        <X>
         <Value>0.392157</Value>
        </X>
        <Y>
         <Value>0.392157</Value>
        </Y>
        <Z>
         <Value>0.392157</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </AmbientLight>
      <AmbientOn>true</AmbientOn>
      <DiffuseOn>false</DiffuseOn>
      <SpecularOn>false</SpecularOn>
     </Light>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Directional Light</Name>
      <Position>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.206284057762329</Value>
        </X>
        <Y>
         <Value>-0.928279259930761</Value>
        </Y>
        <Z>
         <Value>-0.309426086643494</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.218218080712227</Value>
        </X>
        <Y>
         <Value>0.436436161424455</Value>
        </Y>
        <Z>
         <Value>-0.872871322848539</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>3</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>0.501961</Value>
        </X>
        <Y>
         <Value>0.501961</Value>
        </Y>
        <Z>
         <Value>0.501961</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <Attenuation>
       <Constant>
        <Value>1.0</Value>
       </Constant>
       <Linear>
        <Value>0.0</Value>
       </Linear>
       <Quadratic>
        <Value>0.0</Value>
       </Quadratic>
      </Attenuation>
      <DiffuseLight>
       <Color>
        <X>
         <Value>0.501961</Value>
        </X>
        <Y>
         <Value>0.501961</Value>
        </Y>
        <Z>
         <Value>0.501961</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </DiffuseLight>
      <SpecularLight>
       <Color>
        <X>
         <Value>0.501961</Value>
        </X>
        <Y>
         <Value>0.501961</Value>
        </Y>
        <Z>
         <Value>0.501961</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </SpecularLight>
      <AmbientOn>false</AmbientOn>
      <DiffuseOn>true</DiffuseOn>
      <SpecularOn>true</SpecularOn>
     </Light>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Camera Looking At Origin</Name>
      <Position>
       <X>
        <Value>-3.25814419301646</Value>
       </X>
       <Y>
        <Value>1.95358260622668</Value>
       </Y>
       <Z>
        <Value>-3.04622513176334</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.0862994213952137</Value>
        </X>
        <Y>
         <Value>-0.116010782401727</Value>
        </Y>
        <Z>
         <Value>0.989491742377566</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.0100797221432287</Value>
        </X>
        <Y>
         <Value>0.993247954121497</Value>
        </Y>
        <Z>
         <Value>0.115572059058304</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100.0</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>0.004999999999999998</Field>
      <Fieldy>57.2957795130823</Fieldy>
      <PlaneLeft>-0.5</PlaneLeft>
      <PlaneRight>0.5</PlaneRight>
      <PlaneTop>0.5</PlaneTop>
      <PlaneBottom>-0.5</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
       <X>
        <Value>2.26454231811857</Value>
       </X>
       <Y>
        <Value>-5.47046697322705</Value>
       </Y>
       <Z>
        <Value>60.2757834073479</Value>
       </Z>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Y>
        <Value>1</Value>
       </Y>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>true</Perspective>
      <IsSelectedCamera>true</IsSelectedCamera>
     </Camera>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Perspective Camera</Name>
      <Position>
       <X>
        <Value>-36.8428956373596</Value>
       </X>
       <Y>
        <Value>-42.1826401155035</Value>
       </Y>
       <Z>
        <Value>-57.8596715643945</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.440296214683003</Value>
        </X>
        <Y>
         <Value>0.403256391393483</Value>
        </Y>
        <Z>
         <Value>0.802199181086671</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>-0.815657955935535</Value>
        </X>
        <Y>
         <Value>-0.19380533400433</Value>
        </Y>
        <Z>
         <Value>0.545106954120505</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100.0</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>0.0014049900478554354</Field>
      <Fieldy>16.1</Fieldy>
      <PlaneLeft>-0.5</PlaneLeft>
      <PlaneRight>0.5</PlaneRight>
      <PlaneTop>0.5</PlaneTop>
      <PlaneBottom>-0.5</PlaneBottom>
      <UseLookatPosition>false</UseLookatPosition>
      <LookatPosition>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Y>
        <Value>1</Value>
       </Y>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>true</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Front(XY)-Camera</Name>
      <Position>
       <X>
        <Value>181.301936419093</Value>
       </X>
       <Y>
        <Value>11.2688294591945</Value>
       </Y>
       <Z>
        <Value>-4.5560905325606</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>-0.0999115368376177</Value>
        </X>
        <Y>
         <Value>-0.989984340785657</Value>
        </Y>
        <Z>
         <Value>0.0997431190906553</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>-0.700614893866925</Value>
        </X>
        <Y>
         <Value>0.141177211330963</Value>
        </Y>
        <Z>
         <Value>0.699433889293799</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100.0</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>-2.2243588383376924e-178</Field>
      <Fieldy>572.957795130823</Fieldy>
      <PlaneLeft>2.2243588383376924e-178</PlaneLeft>
      <PlaneRight>-2.2243588383376924e-178</PlaneRight>
      <PlaneTop>-2.2243588383376924e-178</PlaneTop>
      <PlaneBottom>2.2243588383376924e-178</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
       <X>
        <Value>180.302821050717</Value>
       </X>
       <Y>
        <Value>1.3689860513373</Value>
       </Y>
       <Z>
        <Value>-3.55865934165398</Value>
       </Z>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Y>
        <Value>1</Value>
       </Y>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>false</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Side(YZ)-Camera</Name>
      <Position>
       <X>
        <Value>-6.90800213866356</Value>
       </X>
       <Y>
        <Value>-2.60737878756115</Value>
       </Y>
       <Z>
        <Value>2.03959211855948</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.0471242109715612</Value>
        </X>
        <Y>
         <Value>-0.90120472120987</Value>
        </Y>
        <Z>
         <Value>0.430824046693483</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>-0.0224971570626915</Value>
        </X>
        <Y>
         <Value>0.430236257344084</Value>
        </Y>
        <Z>
         <Value>0.902435948303619</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100.0</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>-73.50378009774198</Field>
      <Fieldy>230.843205967941</Fieldy>
      <PlaneLeft>73.50378009774198</PlaneLeft>
      <PlaneRight>-73.50378009774198</PlaneRight>
      <PlaneTop>-73.50378009774198</PlaneTop>
      <PlaneBottom>73.50378009774198</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
       <X>
        <Value>-6.43676002894792</Value>
       </X>
       <Y>
        <Value>-11.6194259996604</Value>
       </Y>
       <Z>
        <Value>6.34783258549458</Value>
       </Z>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Z>
        <Value>1</Value>
       </Z>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>false</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Top(XZ)-Camera</Name>
      <Position>
       <X>
        <Value>-5.57395547378793</Value>
       </X>
       <Y>
        <Value>8.79547003084109</Value>
       </Y>
       <Z>
        <Value>27.9496265328609</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.311458687611482</Value>
        </X>
        <Y>
         <Value>-0.467908662292352</Value>
        </Y>
        <Z>
         <Value>-0.827076157111977</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.950259693931787</Value>
        </X>
        <Y>
         <Value>0.153362516383949</Value>
        </Y>
        <Z>
         <Value>0.271083848019482</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100.0</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>-19.691243799318602</Field>
      <Fieldy>165.491181489084</Fieldy>
      <PlaneLeft>19.691243799318602</PlaneLeft>
      <PlaneRight>-19.691243799318602</PlaneRight>
      <PlaneTop>-19.691243799318602</PlaneTop>
      <PlaneBottom>19.691243799318602</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
       <X>
        <Value>-2.4593685976728</Value>
       </X>
       <Y>
        <Value>4.11638340791711</Value>
       </Y>
       <Z>
        <Value>19.6788649617403</Value>
       </Z>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <X>
        <Value>1</Value>
       </X>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>false</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
         </Childs>
        </Frame>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_01</Name>
         <Position>
     <X>
      <VariableName>First_Element\X_A1\output[1]</VariableName>
      <Value>-5.8028405299606425e-5</Value>
     </X>
     <Y>
      <VariableName>First_Element\X_A1\output[2]</VariableName>
      <Value>-1.3208954322000047e-6</Value>
     </Y>
     <Z>
      <VariableName>First_Element\X_A1\output[3]</VariableName>
      <Value>3.14412288120693e-4</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>First_Element\R01\A[1,3]</VariableName>
       <Value>-6.793111866604758e-23</Value>
      </X>
      <Y>
       <VariableName>First_Element\R01\A[2,3]</VariableName>
       <Value>-3.9510370698904825e-24</Value>
      </Y>
      <Z>
       <VariableName>First_Element\R01\A[3,3]</VariableName>
       <Value>1.0</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>First_Element\R01\A[1,2]</VariableName>
       <Value>-0.5990629146122215</Value>
      </X>
      <Y>
       <VariableName>First_Element\R01\A[2,2]</VariableName>
       <Value>0.8007019572452102</Value>
      </Y>
      <Z>
       <VariableName>First_Element\R01\A[3,2]</VariableName>
       <Value>-3.753141082594146e-23</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_02</Name>
         <Position>
     <X>
      <VariableName>FEB_01\Element_02\X_A1\output[1]</VariableName>
      <Value>0.005502002604713058</Value>
     </X>
     <Y>
      <VariableName>FEB_01\Element_02\X_A1\output[2]</VariableName>
      <Value>-2.3008252049448472e-4</Value>
     </Y>
     <Z>
      <VariableName>FEB_01\Element_02\X_A1\output[3]</VariableName>
      <Value>9.320782630102158</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_01\Element_02\R01\A[1,3]</VariableName>
       <Value>-0.0010278711015634487</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_02\R01\A[2,3]</VariableName>
       <Value>-0.006110765098831939</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_02\R01\A[3,3]</VariableName>
       <Value>0.9999808008311487</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_01\Element_02\R01\A[1,2]</VariableName>
       <Value>-0.49966529233416457</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_02\R01\A[2,2]</VariableName>
       <Value>0.8662053742136132</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_02\R01\A[3,2]</VariableName>
       <Value>0.0047796778205621985</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_03</Name>
         <Position>
     <X>
      <VariableName>FEB_01\Element_03\X_A\output[1]</VariableName>
      <Value>-0.003556562258758167</Value>
     </X>
     <Y>
      <VariableName>FEB_01\Element_03\X_A\output[2]</VariableName>
      <Value>-0.05739974227821699</Value>
     </Y>
     <Z>
      <VariableName>FEB_01\Element_03\X_A\output[3]</VariableName>
      <Value>18.64098203464537</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_01\Element_03\R01\A[1,3]</VariableName>
       <Value>-6.518955174707831e-4</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_03\R01\A[2,3]</VariableName>
       <Value>0.012620152834350506</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_03\R01\A[3,3]</VariableName>
       <Value>0.9999201501993407</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_01\Element_03\R01\A[1,2]</VariableName>
       <Value>-0.3929425488262545</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_03\R01\A[2,2]</VariableName>
       <Value>0.9194865230581856</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_03\R01\A[3,2]</VariableName>
       <Value>-0.011861165047987903</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_04</Name>
         <Position>
     <X>
      <VariableName>FEB_01\Element_04\X_A1\output[1]</VariableName>
      <Value>-0.011289811775172775</Value>
     </X>
     <Y>
      <VariableName>FEB_01\Element_04\X_A1\output[2]</VariableName>
      <Value>0.06033286420394616</Value>
     </Y>
     <Z>
      <VariableName>FEB_01\Element_04\X_A1\output[3]</VariableName>
      <Value>27.960790777501828</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_01\Element_04\R01\A[1,3]</VariableName>
       <Value>0.0014115781821108153</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_04\R01\A[2,3]</VariableName>
       <Value>-0.009277549593080643</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_04\R01\A[3,3]</VariableName>
       <Value>0.9999559662908081</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_01\Element_04\R01\A[1,2]</VariableName>
       <Value>-0.2814507699145268</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_04\R01\A[2,2]</VariableName>
       <Value>0.9595306029422955</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_04\R01\A[3,2]</VariableName>
       <Value>0.009299792025362946</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_05</Name>
         <Position>
     <X>
      <VariableName>FEB_01\Element_05\X_A\output[1]</VariableName>
      <Value>0.004718736983180163</Value>
     </X>
     <Y>
      <VariableName>FEB_01\Element_05\X_A\output[2]</VariableName>
      <Value>-0.026515935439068675</Value>
     </Y>
     <Z>
      <VariableName>FEB_01\Element_05\X_A\output[3]</VariableName>
      <Value>37.28101591688897</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_01\Element_05\R01\A[1,3]</VariableName>
       <Value>-0.004998655428444763</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_05\R01\A[2,3]</VariableName>
       <Value>0.0024483663216091534</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_05\R01\A[3,3]</VariableName>
       <Value>0.9999845093531514</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_01\Element_05\R01\A[1,2]</VariableName>
       <Value>-0.1682742342105469</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_05\R01\A[2,2]</VariableName>
       <Value>0.9857348474360141</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_05\R01\A[3,2]</VariableName>
       <Value>-0.0032546353332093773</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_06</Name>
         <Position>
     <X>
      <VariableName>FEB_01\Element_06\X_A1\output[1]</VariableName>
      <Value>-0.0429276834322371</Value>
     </X>
     <Y>
      <VariableName>FEB_01\Element_06\X_A1\output[2]</VariableName>
      <Value>4.1313099834786753e-4</Value>
     </Y>
     <Z>
      <VariableName>FEB_01\Element_06\X_A1\output[3]</VariableName>
      <Value>46.60155845294029</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_01\Element_06\R01\A[1,3]</VariableName>
       <Value>0.0029752914836361087</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_06\R01\A[2,3]</VariableName>
       <Value>0.0053715291600172485</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_06\R01\A[3,3]</VariableName>
       <Value>0.9999811469798171</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_01\Element_06\R01\A[1,2]</VariableName>
       <Value>-0.05381132550067444</Value>
      </X>
      <Y>
       <VariableName>FEB_01\Element_06\R01\A[2,2]</VariableName>
       <Value>0.998537562184757</Value>
      </Y>
      <Z>
       <VariableName>FEB_01\Element_06\R01\A[3,2]</VariableName>
       <Value>-0.005203667359008376</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_07</Name>
         <Position>
     <X>
      <VariableName>FEB_02\Element_07\X_A1\output[1]</VariableName>
      <Value>-0.01470075164179584</Value>
     </X>
     <Y>
      <VariableName>FEB_02\Element_07\X_A1\output[2]</VariableName>
      <Value>0.0556639690882028</Value>
     </Y>
     <Z>
      <VariableName>FEB_02\Element_07\X_A1\output[3]</VariableName>
      <Value>55.921720102218224</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_02\Element_07\R01\A[1,3]</VariableName>
       <Value>0.005913333855270742</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_07\R01\A[2,3]</VariableName>
       <Value>-0.00975327965245213</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_07\R01\A[3,3]</VariableName>
       <Value>0.9999349508936755</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_02\Element_07\R01\A[1,2]</VariableName>
       <Value>0.05929896315553032</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_07\R01\A[2,2]</VariableName>
       <Value>0.9981961443979565</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_07\R01\A[3,2]</VariableName>
       <Value>0.009385642105533954</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_08</Name>
         <Position>
     <X>
      <VariableName>FEB_02\Element_08\X_A\output[1]</VariableName>
      <Value>0.04253515314160749</Value>
     </X>
     <Y>
      <VariableName>FEB_02\Element_08\X_A\output[2]</VariableName>
      <Value>-0.03900638001677209</Value>
     </Y>
     <Z>
      <VariableName>FEB_02\Element_08\X_A\output[3]</VariableName>
      <Value>65.24171282978823</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_02\Element_08\R01\A[1,3]</VariableName>
       <Value>-0.007261268157276596</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_08\R01\A[2,3]</VariableName>
       <Value>0.009982870003472602</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_08\R01\A[3,3]</VariableName>
       <Value>0.9999238052428004</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_02\Element_08\R01\A[1,2]</VariableName>
       <Value>0.1681763209486854</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_08\R01\A[2,2]</VariableName>
       <Value>0.9857192421193629</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_08\R01\A[3,2]</VariableName>
       <Value>-0.008619790472728697</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_09</Name>
         <Position>
     <X>
      <VariableName>FEB_02\Element_09\X_A1\output[1]</VariableName>
      <Value>-0.023407505406209655</Value>
     </X>
     <Y>
      <VariableName>FEB_02\Element_09\X_A1\output[2]</VariableName>
      <Value>0.05156711855583203</Value>
     </Y>
     <Z>
      <VariableName>FEB_02\Element_09\X_A1\output[3]</VariableName>
      <Value>74.5615934240448</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_02\Element_09\R01\A[1,3]</VariableName>
       <Value>2.7877648136728674e-4</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_09\R01\A[2,3]</VariableName>
       <Value>-0.00973160365986973</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_09\R01\A[3,3]</VariableName>
       <Value>0.9999526079639378</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_02\Element_09\R01\A[1,2]</VariableName>
       <Value>0.2729598022575831</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_09\R01\A[2,2]</VariableName>
       <Value>0.9619806221065953</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_09\R01\A[3,2]</VariableName>
       <Value>0.009285959450113354</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_10</Name>
         <Position>
     <X>
      <VariableName>FEB_02\Element_10\X_A\output[1]</VariableName>
      <Value>-0.013644206562804686</Value>
     </X>
     <Y>
      <VariableName>FEB_02\Element_10\X_A\output[2]</VariableName>
      <Value>-0.038328927080170605</Value>
     </Y>
     <Z>
      <VariableName>FEB_02\Element_10\X_A\output[3]</VariableName>
      <Value>83.88157011473858</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_02\Element_10\R01\A[1,3]</VariableName>
       <Value>0.006001374466055617</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_10\R01\A[2,3]</VariableName>
       <Value>0.014444680495843196</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_10\R01\A[3,3]</VariableName>
       <Value>0.9998776598713921</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_02\Element_10\R01\A[1,2]</VariableName>
       <Value>0.37208111356688306</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_10\R01\A[2,2]</VariableName>
       <Value>0.9280684337365176</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_10\R01\A[3,2]</VariableName>
       <Value>-0.01564056356642167</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_11</Name>
         <Position>
     <X>
      <VariableName>FEB_02\Element_11\X_A1\output[1]</VariableName>
      <Value>0.03880596260827675</Value>
     </X>
     <Y>
      <VariableName>FEB_02\Element_11\X_A1\output[2]</VariableName>
      <Value>0.09022858199103835</Value>
     </Y>
     <Z>
      <VariableName>FEB_02\Element_11\X_A1\output[3]</VariableName>
      <Value>93.2015389537699</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_02\Element_11\R01\A[1,3]</VariableName>
       <Value>-0.014204878327664082</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_11\R01\A[2,3]</VariableName>
       <Value>-0.017609650852114102</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_11\R01\A[3,3]</VariableName>
       <Value>0.9997440280534629</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_02\Element_11\R01\A[1,2]</VariableName>
       <Value>0.4653495151680555</Value>
      </X>
      <Y>
       <VariableName>FEB_02\Element_11\R01\A[2,2]</VariableName>
       <Value>0.8848486236789149</Value>
      </Y>
      <Z>
       <VariableName>FEB_02\Element_11\R01\A[3,2]</VariableName>
       <Value>0.022197790574421256</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_12</Name>
         <Position>
     <X>
      <VariableName>FEB_03\Element_12\X_A\output[1]</VariableName>
      <Value>-0.10302821217564288</Value>
     </X>
     <Y>
      <VariableName>FEB_03\Element_12\X_A\output[2]</VariableName>
      <Value>-0.07014252528620162</Value>
     </Y>
     <Z>
      <VariableName>FEB_03\Element_12\X_A\output[3]</VariableName>
      <Value>102.51991911662259</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_03\Element_12\R01\A[1,3]</VariableName>
       <Value>0.015861847860922172</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_12\R01\A[2,3]</VariableName>
       <Value>0.013804642633530127</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_12\R01\A[3,3]</VariableName>
       <Value>0.9997788923678063</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_03\Element_12\R01\A[1,2]</VariableName>
       <Value>0.48508149127344047</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_12\R01\A[2,2]</VariableName>
       <Value>0.8742455035211094</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_12\R01\A[3,2]</VariableName>
       <Value>-0.019767306267091642</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_13</Name>
         <Position>
     <X>
      <VariableName>FEB_03\Element_13\X_A1\output[1]</VariableName>
      <Value>0.046662484634795665</Value>
     </X>
     <Y>
      <VariableName>FEB_03\Element_13\X_A1\output[2]</VariableName>
      <Value>0.06921348201142039</Value>
     </Y>
     <Z>
      <VariableName>FEB_03\Element_13\X_A1\output[3]</VariableName>
      <Value>111.83994340419602</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_03\Element_13\R01\A[1,3]</VariableName>
       <Value>-0.010952158006290055</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_13\R01\A[2,3]</VariableName>
       <Value>-0.006645149408360605</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_13\R01\A[3,3]</VariableName>
       <Value>0.9999179427454764</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_03\Element_13\R01\A[1,2]</VariableName>
       <Value>0.5048664543494824</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_13\R01\A[2,2]</VariableName>
       <Value>0.8631239441779072</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_13\R01\A[3,2]</VariableName>
       <Value>0.011265889195043762</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_14</Name>
         <Position>
     <X>
      <VariableName>FEB_03\Element_14\X_A\output[1]</VariableName>
      <Value>-0.055255873628085976</Value>
     </X>
     <Y>
      <VariableName>FEB_03\Element_14\X_A\output[2]</VariableName>
      <Value>0.0027261867327573034</Value>
     </Y>
     <Z>
      <VariableName>FEB_03\Element_14\X_A\output[3]</VariableName>
      <Value>121.16046215911699</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_03\Element_14\R01\A[1,3]</VariableName>
       <Value>0.008798982503844137</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_14\R01\A[2,3]</VariableName>
       <Value>-0.005316283031662424</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_14\R01\A[3,3]</VariableName>
       <Value>0.9999471561245746</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_03\Element_14\R01\A[1,2]</VariableName>
       <Value>0.524702393143954</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_14\R01\A[2,2]</VariableName>
       <Value>0.8512857277764745</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_14\R01\A[3,2]</VariableName>
       <Value>-9.117612542414427e-5</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_15</Name>
         <Position>
     <X>
      <VariableName>FEB_03\Element_15\X_A1\output[1]</VariableName>
      <Value>0.01872374643087123</Value>
     </X>
     <Y>
      <VariableName>FEB_03\Element_15\X_A1\output[2]</VariableName>
      <Value>-0.04698058362532434</Value>
     </Y>
     <Z>
      <VariableName>FEB_03\Element_15\X_A1\output[3]</VariableName>
      <Value>130.48002342002596</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_03\Element_15\R01\A[1,3]</VariableName>
       <Value>0.0019322607062124298</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_15\R01\A[2,3]</VariableName>
       <Value>0.007991312457176368</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_15\R01\A[3,3]</VariableName>
       <Value>0.9999662020757377</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_03\Element_15\R01\A[1,2]</VariableName>
       <Value>0.5429758332712602</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_15\R01\A[2,2]</VariableName>
       <Value>0.8397124682890272</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_15\R01\A[3,2]</VariableName>
       <Value>-0.007759837841749091</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_16</Name>
         <Position>
     <X>
      <VariableName>FEB_03\Element_16\X_A\output[1]</VariableName>
      <Value>0.038233789550516574</Value>
     </X>
     <Y>
      <VariableName>FEB_03\Element_16\X_A\output[2]</VariableName>
      <Value>0.02685047338548144</Value>
     </Y>
     <Z>
      <VariableName>FEB_03\Element_16\X_A\output[3]</VariableName>
      <Value>139.79958058053637</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_03\Element_16\R01\A[1,3]</VariableName>
       <Value>-0.0047729630564756305</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_16\R01\A[2,3]</VariableName>
       <Value>3.599599071216311e-5</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_16\R01\A[3,3]</VariableName>
       <Value>0.9999886086990942</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_03\Element_16\R01\A[1,2]</VariableName>
       <Value>0.5584311065686656</Value>
      </X>
      <Y>
       <VariableName>FEB_03\Element_16\R01\A[2,2]</VariableName>
       <Value>0.8295467154667509</Value>
      </Y>
      <Z>
       <VariableName>FEB_03\Element_16\R01\A[3,2]</VariableName>
       <Value>0.00263554070761105</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_17</Name>
         <Position>
     <X>
      <VariableName>FEB_04\Element_17\X_A1\output[1]</VariableName>
      <Value>-7.107715067629773e-4</Value>
     </X>
     <Y>
      <VariableName>FEB_04\Element_17\X_A1\output[2]</VariableName>
      <Value>0.023378163188822614</Value>
     </Y>
     <Z>
      <VariableName>FEB_04\Element_17\X_A1\output[3]</VariableName>
      <Value>149.11961615549436</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_04\Element_17\R01\A[1,3]</VariableName>
       <Value>8.114258718195628e-4</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_17\R01\A[2,3]</VariableName>
       <Value>-0.009198371715792585</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_17\R01\A[3,3]</VariableName>
       <Value>0.999957364864039</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_04\Element_17\R01\A[1,2]</VariableName>
       <Value>0.5721914709753653</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_17\R01\A[2,2]</VariableName>
       <Value>0.8200895080641191</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_17\R01\A[3,2]</VariableName>
       <Value>0.00707949900761407</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_18</Name>
         <Position>
     <X>
      <VariableName>FEB_04\Element_18\X_A\output[1]</VariableName>
      <Value>0.005390418465046244</Value>
     </X>
     <Y>
      <VariableName>FEB_04\Element_18\X_A\output[2]</VariableName>
      <Value>-0.057374057600714984</Value>
     </Y>
     <Z>
      <VariableName>FEB_04\Element_18\X_A\output[3]</VariableName>
      <Value>158.43963695625078</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_04\Element_18\R01\A[1,3]</VariableName>
       <Value>0.004842300579558952</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_18\R01\A[2,3]</VariableName>
       <Value>0.008920589989485625</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_18\R01\A[3,3]</VariableName>
       <Value>0.9999484862728364</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_04\Element_18\R01\A[1,2]</VariableName>
       <Value>0.5844689498605501</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_18\R01\A[2,2]</VariableName>
       <Value>0.8113536054317528</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_18\R01\A[3,2]</VariableName>
       <Value>-0.010068445848363913</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_19</Name>
         <Position>
     <X>
      <VariableName>FEB_04\Element_19\X_A1\output[1]</VariableName>
      <Value>0.048891397251260744</Value>
     </X>
     <Y>
      <VariableName>FEB_04\Element_19\X_A1\output[2]</VariableName>
      <Value>0.02735883049035943</Value>
     </Y>
     <Z>
      <VariableName>FEB_04\Element_19\X_A1\output[3]</VariableName>
      <Value>167.76004361758777</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_04\Element_19\R01\A[1,3]</VariableName>
       <Value>-0.01123175500868649</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_19\R01\A[2,3]</VariableName>
       <Value>-0.0013913473110671495</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_19\R01\A[3,3]</VariableName>
       <Value>0.9999359538650888</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_04\Element_19\R01\A[1,2]</VariableName>
       <Value>0.593893646629938</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_19\R01\A[2,2]</VariableName>
       <Value>0.8045058405640437</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_19\R01\A[3,2]</VariableName>
       <Value>0.007790313917665663</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_20</Name>
         <Position>
     <X>
      <VariableName>FEB_04\Element_20\X_A\output[1]</VariableName>
      <Value>-0.054810945658285905</Value>
     </X>
     <Y>
      <VariableName>FEB_04\Element_20\X_A\output[2]</VariableName>
      <Value>0.01260138147757266</Value>
     </Y>
     <Z>
      <VariableName>FEB_04\Element_20\X_A\output[3]</VariableName>
      <Value>177.07998203309097</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_04\Element_20\R01\A[1,3]</VariableName>
       <Value>0.010105279612827294</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_20\R01\A[2,3]</VariableName>
       <Value>-0.005777580727041374</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_20\R01\A[3,3]</VariableName>
       <Value>0.9999322491473556</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_04\Element_20\R01\A[1,2]</VariableName>
       <Value>0.6009560713941225</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_20\R01\A[2,2]</VariableName>
       <Value>0.799280728639748</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_20\R01\A[3,2]</VariableName>
       <Value>-0.0014550187819423058</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_21</Name>
         <Position>
     <X>
      <VariableName>FEB_04\Element_21\X_A1\output[1]</VariableName>
      <Value>0.038124704609199665</Value>
     </X>
     <Y>
      <VariableName>FEB_04\Element_21\X_A1\output[2]</VariableName>
      <Value>-0.0458318569899686</Value>
     </Y>
     <Z>
      <VariableName>FEB_04\Element_21\X_A1\output[3]</VariableName>
      <Value>186.399694354701</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>FEB_04\Element_21\R01\A[1,3]</VariableName>
       <Value>-0.005546621748609366</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_21\R01\A[2,3]</VariableName>
       <Value>0.010280494063875049</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_21\R01\A[3,3]</VariableName>
       <Value>0.9999317708868843</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>FEB_04\Element_21\R01\A[1,2]</VariableName>
       <Value>0.6052808302797182</Value>
      </X>
      <Y>
       <VariableName>FEB_04\Element_21\R01\A[2,2]</VariableName>
       <Value>0.7959973763841763</Value>
      </Y>
      <Z>
       <VariableName>FEB_04\Element_21\R01\A[3,2]</VariableName>
       <Value>-0.0048263117805042235</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
        <Cylinder>
         <CircleElements>16</CircleElements>
         <LowerRadius>3.0</LowerRadius>
         <UpperRadius>3.0</UpperRadius>
         <Height>9.32</Height>
         <Closed>true</Closed>
         <LowerClosed>true</LowerClosed>
         <UpperClosed>true</UpperClosed>
         <CenterInOrigin>false</CenterInOrigin>
         <ShowInnerSide>false</ShowInnerSide>
         <ShowOuterSide>true</ShowOuterSide>
         <ScaleValue>
     <X>
      <Value>0.1</Value>
     </X>
     <Y>
      <Value>0.1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <OverrideColor>true</OverrideColor>
         <MeshColor>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColor>
         <Alpha>1.0</Alpha>
         <MeshColorMultipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </MeshColorMultipliers>
         <MeshColorOffsets>
         </MeshColorOffsets>
         <Direct3DColorRange>true</Direct3DColorRange>
         <SpecularColor>
     <X>
      <Value>0.498039215686275</Value>
     </X>
     <Y>
      <Value>0.498039215686275</Value>
     </Y>
     <Z>
      <Value>0.498039215686275</Value>
     </Z>
         </SpecularColor>
         <EmissiveColor>
         </EmissiveColor>
         <ShininessPower>
     <Value>13.5413365364075</Value>
         </ShininessPower>
         <OverrideQuality>false</OverrideQuality>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Element_32</Name>
         <Position>
     <X>
      <VariableName>Last_Element\Last_Element\X_A\output[1]</VariableName>
      <Value>-0.010882690079922057</Value>
     </X>
     <Y>
      <VariableName>Last_Element\Last_Element\X_A\output[2]</VariableName>
      <Value>0.04650012282710416</Value>
     </Y>
     <Z>
      <VariableName>Last_Element\Last_Element\X_A\output[3]</VariableName>
      <Value>195.71871976705856</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>Last_Element\Last_Element\R01\A[1,3]</VariableName>
       <Value>0.0011780425498447793</Value>
      </X>
      <Y>
       <VariableName>Last_Element\Last_Element\R01\A[2,3]</VariableName>
       <Value>-0.0050067733521302225</Value>
      </Y>
      <Z>
       <VariableName>Last_Element\Last_Element\R01\A[3,3]</VariableName>
       <Value>0.9999867721306873</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>Last_Element\Last_Element\R01\A[1,2]</VariableName>
       <Value>0.6067639988354702</Value>
      </X>
      <Y>
       <VariableName>Last_Element\Last_Element\R01\A[2,2]</VariableName>
       <Value>0.7948753294868935</Value>
      </Y>
      <Z>
       <VariableName>Last_Element\Last_Element\R01\A[3,2]</VariableName>
       <Value>0.003265009998724125</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
        </Cylinder>
       </Childs>
      </Frame>
     </MainFrame>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>3</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Impulse</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-6000.0</Minimum>
       <Maximum>14000.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Impulse</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>3355111</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>FEB_02\Element_10\Pulse\output[1]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>4</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>d_min</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>0.026</Minimum>
       <Maximum>0.046</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>d_min_x</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>3329330</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>FEB_03\Element_13\LateralDampingModel\d_min_x</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <Position>
       <X>0.9680539273153576</X>
       <Y>0.05913978494623656</Y>
      </Position>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>5</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>v</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-0.39999999999999986</Minimum>
       <Maximum>1.6</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>v_in</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711680</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>Definitions\v_in</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>6</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>K</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-0.19999999999999996</Minimum>
       <Maximum>1.8</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>K_in</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>15086320</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>Definitions\K_in</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>7</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Rho</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-400.0</Minimum>
       <Maximum>1600.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Rho_in</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>3355111</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>Definitions\Rho_in</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>8</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Tau</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-1.0</Minimum>
       <Maximum>9.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Tau_in</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>Definitions\Tau_in</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>9</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Damping Constant(R_SSA)</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>20000.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Damping Constant (0.01*Zeta*C_c)</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>55295</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>FEB_03\Element_13\LateralDampingModel\R_SSA_p[1,1]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>10</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Axial Force</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-5000.0</Minimum>
       <Maximum>45000.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Apparent Weight (N) Vs.Time</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>3355111</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>C1\p.e[3]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <Position>
       <X>0.7099792099792099</X>
       <Y>0.3972222222222222</Y>
      </Position>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <PlotId>11</PlotId>
       <UseWindowsBGColor>false</UseWindowsBGColor>
       <BGColor>16777215</BGColor>
       <PlotIsVisible>true</PlotIsVisible>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <GridBorderLineColor>12624260</GridBorderLineColor>
      <GridZeroLineColor>0</GridZeroLineColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>false</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>model</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
      <LegendFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LegendFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0.0</Minimum>
       <Maximum>7.278795521438644</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-1000.0</Minimum>
       <Maximum>9000.0</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Wellbore Contact</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>4718664</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3355111</TickColor>
       <TickStyle>0</TickStyle>
       <CurveVisible>true</CurveVisible>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>2</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>FEB_02\Element_11\WBContact\p.e[1]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
      <BorderPenColor>0</BorderPenColor>
      <BackgroundColor>16777215</BackgroundColor>
     </Legenda>
    </Plot>
   </Plots>
   <PlotPanels>
    <PlotPanel>
     <PlotPanelId>1</PlotPanelId>
     <PlotPanelVisible>true</PlotPanelVisible>
     <Name>Responses</Name>
     <Tiling>2</Tiling>
     <PlotIds>
       <PlotId>1</PlotId>
       <PlotId>10</PlotId>
       <PlotId>11</PlotId>
     </PlotIds>
     <ToggleState>Base</ToggleState>
    </PlotPanel>
    <PlotPanel>
     <PlotPanelId>2</PlotPanelId>
     <PlotPanelVisible>false</PlotPanelVisible>
     <Name>Animation</Name>
     <Tiling>0</Tiling>
     <PlotIds>
       <PlotId>2</PlotId>
     </PlotIds>
     <ToggleState>Base</ToggleState>
    </PlotPanel>
    <PlotPanel>
     <PlotPanelId>3</PlotPanelId>
     <PlotPanelVisible>true</PlotPanelVisible>
     <Name>Damping Constant and relevant variables</Name>
     <Tiling>2</Tiling>
     <PlotIds>
       <PlotId>3</PlotId>
       <PlotId>4</PlotId>
       <PlotId>5</PlotId>
       <PlotId>6</PlotId>
       <PlotId>7</PlotId>
       <PlotId>8</PlotId>
       <PlotId>9</PlotId>
     </PlotIds>
     <ToggleState>Base</ToggleState>
    </PlotPanel>
   </PlotPanels>
   <WindowRectangles virtualDesktopWidth="3840" virtualDesktopHeight="1080">
     <WindowRectangle monitor="0" left="0" top="0" right="1920" bottom="1080" plotpanelid="2">
0.000520833 0.0305556 0.998437 0.962037
     </WindowRectangle>
     <WindowRectangle monitor="1" left="-1920" top="0" right="0" bottom="1080" plotpanelid="1">
0 0 1.00417 0.971296
     </WindowRectangle>
     <WindowRectangle monitor="1" left="-1920" top="0" right="0" bottom="1080" plotpanelid="3">
0.00416667 0.0305556 1.00208 0.962037
     </WindowRectangle>
   </WindowRectangles>
  </PlotSpecs>
  <RunSpecs>
   <SimulatorSettings>
    <StartTime>0.0</StartTime>
    <FinishTime>100.0</FinishTime>
    <Warp>false</Warp>
    <FPGonio>true</FPGonio>
    <UseOutputAfterEach>false</UseOutputAfterEach>
    <OutputAfterEach>0.1</OutputAfterEach>
    <EventEpsilon>1.0e-6</EventEpsilon>
    <AlgebraicTolerance>1.0e-7</AlgebraicTolerance>
    <SteadyStateAnalysis>false</SteadyStateAnalysis>
    <UpdateHoldInstructions>false</UpdateHoldInstructions>
   </SimulatorSettings>
   <IntegrationMethods>
    <IntegrationMethod>
     <Name>Euler</Name>
     <StepSize>0.01</StepSize>
     <AutoStepSize>false</AutoStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BackwardEuler</Name>
     <AbsoluteTolerance>1.0e-5</AbsoluteTolerance>
     <RelativeTolerance>1.0e-5</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1.0e-5</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1.0e-5</AlgebraicRelativeTolerance>
     <StepSize>0.01</StepSize>
     <Alpha>1.0</Alpha>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>AdamsBashforth</Name>
     <StepSize>0.01</StepSize>
     <AutoStepSize>false</AutoStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta2</Name>
     <StepSize>0.01</StepSize>
     <AutoStepSize>false</AutoStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta4</Name>
     <StepSize>0.01</StepSize>
     <AutoStepSize>false</AutoStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta8</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0.0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0.0</MaximumStepSize>
     <AbsoluteTolerance>1.0e-6</AbsoluteTolerance>
     <RelativeTolerance>1.0e-6</RelativeTolerance>
     <SafetyFactor>0.9</SafetyFactor>
     <Factor1>0.33</Factor1>
     <Factor2>6.0</Factor2>
     <Beta>0.0</Beta>
     <UseMaxNrSteps>false</UseMaxNrSteps>
     <MaxNrSteps>100000</MaxNrSteps>
     <UseStiffDetection>false</UseStiffDetection>
     <MaxNrStiffnessSteps>1000</MaxNrStiffnessSteps>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKuttaFehlberg</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0.0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0.0</MaximumStepSize>
     <AbsoluteTolerance>1.0e-6</AbsoluteTolerance>
     <RelativeTolerance>1.0e-6</RelativeTolerance>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>VodeAdams</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0.0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0.0</MaximumStepSize>
     <AbsoluteTolerance>1.0e-6</AbsoluteTolerance>
     <RelativeTolerance>1.0e-6</RelativeTolerance>
     <VodeUseBDF>true</VodeUseBDF>
     <VodeUseNewton>true</VodeUseNewton>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BDFMethod</Name>
     <AbsoluteTolerance>1.0e-5</AbsoluteTolerance>
     <RelativeTolerance>1.0e-5</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1.0e-5</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1.0e-5</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0.0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0.0</MaximumStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>MeBDFiMethod</Name>
     <AbsoluteTolerance>1.0e-5</AbsoluteTolerance>
     <RelativeTolerance>1.0e-5</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1.0e-5</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1.0e-5</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0.0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0.0</MaximumStepSize>
    </IntegrationMethod>
    <SelectedIntegrationMethod>9</SelectedIntegrationMethod>
   </IntegrationMethods>
  </RunSpecs>
  <MultipleRun>
   <NrSteps>10</NrSteps>
   <CopyFromStates>false</CopyFromStates>
   <JoinParameterVariation>true</JoinParameterVariation>
   <ClearAfterRun>true</ClearAfterRun>
   <RedrawAfterRun>false</RedrawAfterRun>
   <DrawDuringSimulation>true</DrawDuringSimulation>
   <ActionBeforeOptimization>0</ActionBeforeOptimization>
   <CompareValue>0.0</CompareValue>
   <UseCompareValue>true</UseCompareValue>
   <MultipleRunType>MultipleRun</MultipleRunType>
   <Minimize>true</Minimize>
   <OptimizationVariable></OptimizationVariable>
   <ResulVarUsage>UseEndValue</ResulVarUsage>
   <Tolerance>0.01</Tolerance>
   <OptimizationMethod>BroydonFletcherGoldfarbShanno</OptimizationMethod>
   <MultipleRunVariables>
   </MultipleRunVariables>
  </MultipleRun>
  <ExportData>
   <WriteAsText>true</WriteAsText>
   <ReadAsText>true</ReadAsText>
   <WriteHeader>true</WriteHeader>
   <ReadHeader>true</ReadHeader>
   <ReadFilename></ReadFilename>
   <WriteFilename></WriteFilename>
   <DoWrite>false</DoWrite>
   <ExportVariables>
   </ExportVariables>
   <ImportVariables>
   </ImportVariables>
  </ExportData>
  <BreakPoints>
  </BreakPoints>
  <AnimationPlayback>
   <PlaybackSpeed>1.0</PlaybackSpeed>
  </AnimationPlayback>
</ExpData>
  </Experiment>
</Experiments>
</Document>
